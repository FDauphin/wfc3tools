

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>wfc3tools package &mdash; wfc3tools 1.3.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="wfc3tools 1.3.1 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> wfc3tools
          

          
            
            <img src="_static/stsci_pri_combo_mark_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="calwf3.html">calwf3</a></li>
<li class="toctree-l1"><a class="reference internal" href="wf3cte.html">wf3cte</a></li>
<li class="toctree-l1"><a class="reference internal" href="wf3ccd.html">wf3ccd</a></li>
<li class="toctree-l1"><a class="reference internal" href="wf32d.html">wf32d</a></li>
<li class="toctree-l1"><a class="reference internal" href="wf3ir.html">wf3ir</a></li>
<li class="toctree-l1"><a class="reference internal" href="wf3rej.html">wf3rej</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Software History</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embedsub.html">embedsub</a></li>
<li class="toctree-l1"><a class="reference internal" href="pstat.html">pstat</a></li>
<li class="toctree-l1"><a class="reference internal" href="pstack.html">pstack</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampinfo.html">sampinfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="sub2full.html">sub2full</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">wfc3tools</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>wfc3tools package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/wfc3tools.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="wfc3tools-package">
<h1>wfc3tools package<a class="headerlink" href="#wfc3tools-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-wfc3tools.calwf3">
<span id="wfc3tools-calwf3-module"></span><h2>wfc3tools.calwf3 module<a class="headerlink" href="#module-wfc3tools.calwf3" title="Permalink to this headline">¶</a></h2>
<p>CALWF3 calibrates UVIS and IR images for WFC3</p>
<dl class="function">
<dt id="wfc3tools.calwf3.calwf3">
<code class="descclassname">wfc3tools.calwf3.</code><code class="descname">calwf3</code><span class="sig-paren">(</span><em>input</em>, <em>printtime=False</em>, <em>save_tmp=False</em>, <em>verbose=False</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.calwf3.calwf3" title="Permalink to this definition">¶</a></dt>
<dd><p>calwf3 Version 1.3.1  updated on  unspecified</p>
<p><code class="docutils literal"><span class="pre">calwf3</span></code> is the name of the  main executable which processes data from the WFC3 instrument onboard Hubble taken with either the UVIS or IR detectors. The code automatically calls the
appropriate tasks, but users may also run the tasks independently if they desire special processing for their datasets. <a class="reference internal" href="wf3cte.html#wf3cte"><span>wf3cte</span></a>, <a class="reference internal" href="wf3ccd.html#wf3ccd"><span>wf3ccd</span></a> and <a class="reference internal" href="wf32d.html#wf32d"><span>wf32d</span></a> are used for processing UVIS images, while IR image processing is done with <a class="reference internal" href="wf3ir.html#wf3ir"><span>wf3ir</span></a>. The <a class="reference internal" href="wf3rej.html#wf3rej"><span>wf3rej</span></a> program is used for both UVIS and IR images to combine multiple exposures contained in a CR-SPLIT or REPEAT-OBS set. <a class="pageref" href="#calflow">Figure 1</a> is the flow diagram for the pipeline as a whole.</p>
<div class="figure align-center" id="id17">
<span id="calflow"></span><img alt="Flow diagram for ``calwf3`` data using " src="_images/calwf3_flow.png" />
<p class="caption"><span class="caption-text">Figure 1: Flow diagram for <code class="docutils literal"><span class="pre">calwf3</span></code> data. <a class="reference internal" href="wf3cte.html#wf3cte"><span>wf3cte</span></a> occurs as the very first step, before <a class="reference internal" href="wf3ccd.html#wf3ccd"><span>wf3ccd</span></a>.</span></p>
</div>
<p>During automatic pipeline processing by the STScI archive, <code class="docutils literal"><span class="pre">Astrodrizzle</span></code> follows <code class="docutils literal"><span class="pre">calwf3</span></code>. All calibrated images are corrected for geometric distortion correction and associated sets of dithered images are combined into a single product. See the WFC3 Data Handbook for more information, or <a class="reference external" href="http://www.stsci.edu/hst/HST_overview/drizzlepac/">Astrodrizzle</a> .</p>
<p><code class="docutils literal"><span class="pre">calwf3</span></code> is part of HSTCAL package, which can be downloaded from
<a class="reference external" href="http://www.stsci.edu/institute/software_hardware/stsdas/download-stsdas">http://www.stsci.edu/institute/software_hardware/stsdas/download-stsdas</a>
and is installed along with the STScI distributed package Ureka.</p>
<p>A detailed description of the improved <code class="docutils literal"><span class="pre">calwf3</span></code>, Version 3.3, which is more generally referred to as the UVIS2.0 update, will be available in a future publication of WFC3 Data Handbook and several ISRs which will accompany the update.</p>
<p>The current WFC3 Data Handbook can be found at  <a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/handbooks/currentDHB/">http://www.stsci.edu/hst/wfc3/documents/handbooks/currentDHB/</a> .  
In the meantime, if you have questions not answered in this documentation, please contact STScI Help Desk (help[at]stsci.edu).</p>
<p><code class="docutils literal"><span class="pre">calwf3</span></code> can be run on a single input raw file or an asn table listing the members of an associtaion. 
When processing an association, it retrieves calibration switch and reference file keyword settings from 
the first image listed in the asn table. <code class="docutils literal"><span class="pre">calwf3</span></code> does not accept a user-defined list of input images on the 
command line (e.g. <code class="docutils literal"><span class="pre">*raw.fits</span></code> to process all raw files in the current directory).</p>
<p>The <a class="reference internal" href="wf3ccd.html#wf3ccd"><span>wf3ccd</span></a>, <a class="reference internal" href="wf32d.html#wf32d"><span>wf32d</span></a>, <a class="reference internal" href="wf3cte.html#wf3cte"><span>wf3cte</span></a> and <a class="reference internal" href="wf3ir.html#wf3ir"><span>wf3ir</span></a> tasks on the other hand, will accept such user-defined input file lists, but they will not accept an association table( asn ) as input.</p>
<blockquote>
<div><p>In Python without TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">calwf3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calwf3</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>In Python with TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stsci.tools</span> <span class="kn">import</span> <span class="n">teal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">calwf3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teal</span><span class="o">.</span><span class="n">teal</span><span class="p">(</span><span class="s1">&#39;calwf3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In Pyraf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wfc3tools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epar</span> <span class="n">calwf3</span>
</pre></div>
</div>
</div></blockquote>
<p>The recommended method for running <code class="docutils literal"><span class="pre">calwf3</span></code> in batch mode is to use Python and
the <code class="docutils literal"><span class="pre">wfc3tools</span></code> package in the <a class="reference external" href="http://www.stsci.edu/institute/software_hardware/stsdas/download-stsdas">STSDAS distribution</a> .</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">calwf3</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>

<span class="k">for</span> <span class="n">fits</span> <span class="ow">in</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;j*_raw.fits&#39;</span><span class="p">):</span>
    <span class="n">calwf3</span><span class="p">(</span><span class="n">fits</span><span class="p">)</span>
</pre></div>
</div>
<p><cite>calwf3</cite>  can also be called directly from the OS command line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calwf3</span><span class="o">.</span><span class="n">e</span> <span class="n">iaa001kaq_raw</span><span class="o">.</span><span class="n">fits</span> <span class="p">[</span><span class="n">command</span> <span class="n">line</span> <span class="n">options</span><span class="p">]</span>
</pre></div>
</div>
<p>The command line executable only accepts one file at a time, but you can use os tools like <cite>awk</cite> to process everything in a directory:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ls</span> <span class="o">*</span><span class="n">raw</span><span class="o">.</span><span class="n">fits</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print &quot;calwf3.e&quot;,$1}&#39;</span> <span class="o">|</span> <span class="n">csh</span>
</pre></div>
</div>
<p>The following options are available</p>
<ul class="simple">
<li>t: Print verbose time stamps.</li>
<li>s: Save temporary files.</li>
<li>v: Turn on verbose output.</li>
<li>d: Turn on debug output.</li>
<li>q: Turn on quiet output.</li>
<li>r: Print the current software version number (with full revision information)</li>
<li>&#8211;version: Print the current software version number only</li>
</ul>
<ul class="simple">
<li>_asn file: name of an association table</li>
<li>_raw file: name of an individual, uncalibrated exposure</li>
<li>_crj file: name of any sub-product from an association table</li>
</ul>
<p>While both CR-SPLIT and REPEAT-OBS exposures from an association get combined using <cite>calwf3</cite>, dithered observations from an association do not.</p>
<div class="figure align-center" id="id18">
<span id="uvis-data-format"></span><img alt="UVIS data raw file format" src="_images/uvis_data_format.png" />
<p class="caption"><span class="caption-text">Figure 2: UVIS data raw file format</span></p>
</div>
<div class="figure align-center" id="id19">
<span id="ir-data-format"></span><img alt="IR data raw file format" src="_images/ir_data_format.png" />
<p class="caption"><span class="caption-text">Figure 3: IR data raw file format</span></p>
</div>
<ul class="simple">
<li>The science image contains the data from the focal plane array detectors.</li>
<li>The error array contains an estimate of the statistical uncertainty associated with each correcsponding science image pixel</li>
<li>The data quality array contains independent flags indicating various status and problem conditions associated with each correspoinding pixel in the science image</li>
<li>The sample array (IR ONLY) contains the number of samples used to derive the corresponding pixel values in the science image.</li>
<li>The time array (IR ONLY) contains the effective integration time associated with each corresponding science image pixel value.</li>
</ul>
<p>The suffixes used for WFC3 raw and calibrated data products closely mimic those used by ACS and NICMOS:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="64%" />
<col width="26%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">SUFFIX</th>
<th class="head">DESCRIPTION</th>
<th class="head">UNITS</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>_raw</td>
<td>raw data</td>
<td>DN</td>
</tr>
<tr class="row-odd"><td>_rac</td>
<td>UVIS CTE corrected raw data, no other calibration</td>
<td>DN</td>
</tr>
<tr class="row-even"><td>_asn</td>
<td>association file for observation set</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>_spt</td>
<td>telescope and wfc3 telemetry and engineering data</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>_blv_tmp</td>
<td>overscan-trimmed UVIS exposure</td>
<td>DN</td>
</tr>
<tr class="row-odd"><td>_blc_tmp</td>
<td>overscan0trimmed UVIS, CTE corrected exposure</td>
<td>DN</td>
</tr>
<tr class="row-even"><td>_crj_tmp</td>
<td>uncalibrated, cosmic-ray rejected combined</td>
<td>DN</td>
</tr>
<tr class="row-odd"><td>_crc_tmp</td>
<td>uncalibrated, cosmic-rat rejected, cte cleaned</td>
<td>DN</td>
</tr>
<tr class="row-even"><td>_ima</td>
<td>calibrated intermediate IR multiaccum image</td>
<td><span class="math">\(e^{-}/s\)</span></td>
</tr>
<tr class="row-odd"><td>_flt</td>
<td>UVIS calibrated exposure</td>
<td><span class="math">\(e^{-}\)</span></td>
</tr>
<tr class="row-even"><td>_flc</td>
<td>UVIS calibrated exposure including CTE correction</td>
<td><span class="math">\(e^{-}\)</span></td>
</tr>
<tr class="row-odd"><td>_flt</td>
<td>IR calibrated exposure</td>
<td><span class="math">\(e^{-}/s\)</span></td>
</tr>
<tr class="row-even"><td>_crj</td>
<td>UVIS calibrated, cosmic ray rejected image</td>
<td><span class="math">\(e^{-}\)</span></td>
</tr>
<tr class="row-odd"><td>_crj</td>
<td>IR calibrated, cosmic ray rejected image</td>
<td><span class="math">\(e^{-}/s\)</span></td>
</tr>
<tr class="row-even"><td>_crc</td>
<td>UVIS calibrated, cr rejected, cte cleaned image</td>
<td><span class="math">\(e^{-}\)</span></td>
</tr>
<tr class="row-odd"><td>.tra</td>
<td>trailer file, contains processing messages</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>** DRZ and DRC products are produced with Astrodrizzle, see <a class="reference external" href="http://www.stsci.edu/hst/HST_overview/drizzlepac/">Astrodrizzle</a> **</p>
<p><cite>calwf3</cite> processing is controlled by the values of keywords in the input image headers. Certain keywords, referred to as calibration switches, are used to control which calibration steps are performed. Reference file keywords indicate which reference files to use in the various calibration steps. Users who which to perform custom reprocessing of their data may change the values of these keywords in the _raw FITS file headers and then rerun the modified file through  <cite>calwf3</cite>. See the <a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/handbooks/currentDHB/wfc3_Ch25.html">WFC3 Data Handbook</a> for a more complete description of these keywords and their values.</p>
<p>As of version 3.3, the calwf3 pipeline processes all UVIS data twice, once with the CTE correction applied as the first step, and a second time without the CTE correction. A short description of the calibration steps, in the order they are performed:</p>
<ul class="simple">
<li>Calculate and remove and CTE found in the image (PCTECORR)</li>
<li>Calculate a noise model for each pixel and record in the error array (ERR) of the image (NOISCORR)</li>
<li>Initialize the data quality(DQ) array of the image (DQICORR)</li>
<li>Correct fo A-toD conversion errors where necessary, currently skipped (ATODCORR)</li>
<li>Subtract bias level determined from overscan regions (BLEVCORR)</li>
<li>Subtract the bias image (BIASCORR)</li>
<li>Detect and record SINK pixels in the DQ mask (performed if DQICORR is set to PERFORM)</li>
<li>Perform unit conversion</li>
<li>Subtract the post-flash image if applicable (FLSHCORR)</li>
<li>Scale and subtract the dark image (DARKCORR)</li>
<li>Perform flatfielding (FLATCORR)</li>
<li>Perform shutter-shading correction where necessary, currently skipped (SHADCORR)</li>
<li>Populate photometric header keywords (PHOTCORR)</li>
<li>Correct chips to be on the same zeropoint (FLUXCORR)</li>
<li>Calculate image statistics for the header</li>
</ul>
<p>The charge transfer (CTE) of the UVIS detector has been declining over time as on-orbit radiation damage creates charge traps in the CCDs. Faint sources in particular can suffer large flux losses or even be lost entirely if observtions are not planned and analyzed carefully. The CTE depends on the morphology of the source, the distribution of electrons in the field of view, and the population of charge traps in the detector column between the source and the transfer register. Further details of the current understanding of the state of the WFC3/UVIS charge transfer efficieny (CTE) are presented in <a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/handbooks/currentIHB/c05_detector5.html#392274">Section 5</a>  of the data handbook as well as on the <a class="reference external" href="http://www.stsci.edu/hst/wfc3/ins_performance/CTE/">WFC3 CTE webpage</a> .  The PCTECORR step aims to mitigate the flux loss incurred from CTE.</p>
<p>More information on this part of the pipeline can be found in the <a class="reference internal" href="wf3cte.html#wf3cte"><span>wf3cte</span></a> documentation.</p>
<p>The image error array is initialized. The function examines the RR extension of the input data to determine the state of the array. The input _raw image contains an empty ERR array. If the ERR array has already been expanded and contains values other than zero, then this function does nothing. Otherwise it will intialize the ERR array by assigning pixel values based on a simple noise model. The noise model uses the science (SCI) array and for each pixel calculates the error value <span class="math">\(\sigma\)</span> in units of DN:</p>
<div class="math">
\[\sigma_{CCD} = \sqrt{(SCI-bias)/(gain) + (readnoise/gain)^{2}}\]</div>
<p>The CCDTAB reference file contains the bias, gain and readnoise values used for each CCD aplifier quadrant used in this calculation. The table contains one row for each configuration that can be used during readouse, which is uniquely identified by the list of amplifiers (replicated in the CCDAMP header keyword), the particular chip being read out (CCDCHIP), the commanded gain (CCDGAIN), the commanded bias offset level (CCDOFST) and the pixel bin size (BINAXIS). These commanded values are used to find the table row that matches the characteristics of the image that is being processed and reads each amplifiers characteristics, including readnoise (READNSE), A-to-D gain (ATODGN) and the mean bias level (CCDBIAS).</p>
<p>This step initializas the data quality array by reading a table of known bad pixels for the detector, as stored in the Bad Pixel reference table BPIXTAB. The types of bad pixels that can be flagged are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="8%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">NAME</th>
<th class="head">VALUE</th>
<th class="head">DESCRIPTION</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GOODPIXEL</td>
<td>0</td>
<td>OK</td>
</tr>
<tr class="row-odd"><td>SOFTERR</td>
<td>1</td>
<td>Reed-Solomon decoding error</td>
</tr>
<tr class="row-even"><td>DATALOST</td>
<td>2</td>
<td>data replaced by fill value</td>
</tr>
<tr class="row-odd"><td>DETECTORPROB</td>
<td>4</td>
<td>bad detector pixel or beyond aperture</td>
</tr>
<tr class="row-even"><td>DATAMASKED</td>
<td>8</td>
<td>masked by occulting bar</td>
</tr>
<tr class="row-odd"><td>HOTPIX</td>
<td>16</td>
<td>hot pixel</td>
</tr>
<tr class="row-even"><td>CTETAIL</td>
<td>32</td>
<td>UVIS CTE tail</td>
</tr>
<tr class="row-odd"><td>WARMPIX</td>
<td>64</td>
<td>warm pixel</td>
</tr>
<tr class="row-even"><td>BADBIAS</td>
<td>128</td>
<td>bad bias value</td>
</tr>
<tr class="row-odd"><td>SATPIXEL</td>
<td>256</td>
<td>full-well or a-to-d saturated pixel</td>
</tr>
<tr class="row-even"><td>BADFLAT</td>
<td>512</td>
<td>bad flatfield value</td>
</tr>
<tr class="row-odd"><td>TRAP</td>
<td>1024</td>
<td>UVIS charge trap, SINK pixel</td>
</tr>
<tr class="row-even"><td>ATODSAT</td>
<td>2048</td>
<td>a-to-d saturated pixel</td>
</tr>
<tr class="row-odd"><td>ne TBD</td>
<td>4096</td>
<td>reserved for Multidrizzle CR rej</td>
</tr>
<tr class="row-even"><td>DATAREJECT</td>
<td>8192</td>
<td>rejected during image combination UVIS, IR CR rejection</td>
</tr>
<tr class="row-odd"><td>CROSSTALK</td>
<td>16384</td>
<td>ghost or crosstalk</td>
</tr>
<tr class="row-even"><td>RESERVED2</td>
<td>32768</td>
<td>can&#8217;t use</td>
</tr>
</tbody>
</table>
<p>Sink pixels are a type of image defect. These pixels contain a number of charge traps and under-report the number of electrons that were generated in them during an exposure. These pixels can have an impact on nearby upstread or downstream pixels, though they often only impact one or two pixels when the background is high, they can impact up to 10 pixels if the background is low.</p>
<p>Flagging of SINK pixels in the DQ extension of calibrated images is controlled with the DQICORR header keyword, happens after the bias correction has been performed, and is done in the amp-rotated CDAB full image format used and described in the CTE correction. When set to perform, the sink pixels are located and flagged with help from the SNKCFILE reference image. Given the reference image, the procedure for flagging the sink pixel in science data involves:</p>
<ul class="simple">
<li>Extract the MJD of the science exposure</li>
<li>Go through the reference image pixel by pixel looking for those pixels with values greater than 999, which indicates that the current pixel is a sink pixel. The value of this pixel in the reference file corresponds to the date at which this pixel exibited the sink behavior.</li>
<li>If the turn on date of the sink pixel is after the exposure date of the science image, then we ignore the sink pixel in this exposure and move on to the next pixel</li>
<li>If the turn on date of the sink pixel is before the exposure date of the science image, then this science pixel was compromised at the time of the exposure.The corresponding DQ extension pixel for this science pixel is flagged with the &#8220;charge trap&#8221; flag of 1024.</li>
<li>If the pixel &#8220;below&#8221; the sink pixel in the long format image has a value of -1 in the reference image, then it is also flagged with the &#8220;charge trap&#8221; value in the DQ extension. We then proceed vertically &#8220;up&#8221; from the sink pixel and compare each pixel in the reference file to the value of the sink pixel in the science exposure at hand. If the value of the sink pixel in the exposure is below the value of the upstream pixel in the reference image, we flag that pixel with the &#8220;charge trap&#8221; value in the DQ extension. We continue to flag pixels until the value of the pixel in the reference image is zero or until the value of the sink pixel in the exposure is greater than the value of the upstream pixel in the reference image.</li>
</ul>
<p><a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/ISRs/WFC3-2014-19.pdf">WFC3 ISR 2014-19</a> has a detailed analysis on detection of the sink pixels, while the strategy for flagging them is discussed in <a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/ISRs/WFC3-2014-22.pdf">WFC3 ISR 2014-22</a> .</p>
<p>Sink pixels are currently only flagged in full frame science images, a future release of <cite>calwf3</cite> will also perform flagging in subarray images.
<strong>The pipeline currently does no further analysis or correction on pixels which have been flagged as affected by sink pixels</strong></p>
<p>The UVIS image is multiplied by gain right after BIASCORR, converting it to ELECTRONS. This step is no longer embedded within FLATCORR.</p>
<p>This step subtracts the two dimensional bias struction from the image using the superbias reference image listed in the header keyword BIASFILE. The dimensions of the image are used to distinguish between full and sub-array images. Because the bias image is already overscan-subtracted, it will have a mean pixel value of less than one. The BIASFILE has the same dimensions as a full-size science image, complete with overscan regions. Only after completion of <a class="reference internal" href="wf3ccd.html#wf3ccd"><span>wf3ccd</span></a> are the science images trimmed to their final calibrated size. The same reference image is used for full-frame and subarray images, <cite>calwf3</cite> will extract the matching region from the full-size bias file and apply it to the subarray image.</p>
<p>The location of the overscan regions in a raw image varies, depending upon the type of readout that is performed. The overscan regions are used to monitor the instrument as well as provide a measure of the bias level at the time the detector was exposed. The bias level which is calculated for subtraction is done on a line-by-line basis in the image. If the image has no overscan region the BIAS level to be subtracted is obtained from the CCDTAB reference file. Otherwise, the columns to use for the calculation are referenced in the OSCNTAB reference file. A bias drift calculation is made if there are virtual overscan pixels which exist, if neither of the virtual overscan regions are specfied then the physical overscan region is used.</p>
<p>If there are two sections available to use for the line because only 1 amp was used then they are averaged. The parallel overscan region is split into two if there is more than one amp. If the virtual overscan is used, a straight line is fit as a function of the column number. The fit is evaluated for each line and then subtracted from the data.  Iterative sigma clipping is used to reject outliers from the array of bias values.</p>
<p>The mean value of all the bias levels which were subtracted is recorded in the SCI extension output header in MEANBLEV.</p>
<p>The reference file listed under the DARKFILE header keyword is used as the reference dark image.</p>
<p>In the UVIS, the dark image is scaled by EXPTIME and FLASHDUR.</p>
<p>The reference file pointed to with DARKFILE is used for the non-CTE corrected data.</p>
<p>The reference file pointed to with DRKCFILE is used for the CTE corrected data</p>
<p>This step corrects the science image for differential exposure time across the detector cased by the amount of time it takes for the shutter to completely open and close, which is a potentially signiciant effect only for images with very short exposure times (less than ~5 seconds). Pixels are corrected based on the exposure time using the relation:</p>
<div class="math">
\[corrected = uncorrected \times EXPTIME \div (EXPTIME + SHADFILE)\]</div>
<p>WFC3 tests have shown that the shutter shading effect is insignificant (&lt; 1%), even for the shortest allowed UVIS exposure time of 0.5 seconds (see <a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/ISRs/WFC3-2007-17.pdf">WFC3 ISR 2007-17</a>). Therefore this step is <strong>ALWAYS set to OMIT</strong> in <cite>calwf3</cite>.</p>
<p>WFC3 has post-flash capability to provide a means of mitigating the effects of Charge Transfer Efficiency (CTE) degredation.  When FLSHCORR=PERFORM, this routine subtracts the post-flash reference image, FLSHFILE, from the science image after DARKCORR in the WF32D step. The success of the post-flash operation during the exposure is first verified by checking the keyword FLASHSTA. The FLSHFILE is renormalized to the appropriate post-flash current level (LOW, MED, HIGH) recorded in the FLASHCUR keyword, and the flash duration (FLASHDUR) and is then subtracted from the science image. The mean value of the scaled post-flash image is written to MEANFLSH in the output SCI extension header. Different members of an association can have different values of SHUTRPOS because it varies by exposure, and this is fine for calibration because the references files are populated separately for each exposure.</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">KEYWORD</th>
<th class="head">DESCRIPTION</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>FLSHDUR</td>
<td>is the length of time of the flash exposure</td>
</tr>
<tr class="row-odd"><td>FLSHCUR</td>
<td>is the current that was used to the lamp as calculated by TRANS, which also calculates FLASHEXP, (ZERO, LOW, MED,HIGH)</td>
</tr>
<tr class="row-even"><td>FLSHFILE</td>
<td>is the flash reference file, which has an illumination pattern for each shutter</td>
</tr>
<tr class="row-odd"><td>SHUTRPOS</td>
<td>says which shutter was used</td>
</tr>
<tr class="row-even"><td>FLASHSTA</td>
<td>indicates an interrupted exposure (ABORTED, SUCCESSFUL, NOT PERFORMED)</td>
</tr>
<tr class="row-odd"><td>FLASHLVL</td>
<td>post flash level in electrons</td>
</tr>
<tr class="row-even"><td>MEANFLSH</td>
<td>the mean level which <cite>calwf3</cite> calculated and then subtracted</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Futher reading:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/ISRs/WFC3-2013-12.pdf">WFC3 Post-Flash Calibration ISR</a></li>
<li><a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/handbooks/currentIHB/c06_uvis10.html#439394">CTE-Loss Mitigation Before Data Acquisition</a></li>
</ul>
</dd>
</dl>
<p>Correct the image for pixel quantum efficiency using the reference image specified by the FLATFILE keyword in the header.
Conversion from DN to ELECTRONS no longer depends on FLATCORR=PERFORM, all images are converted appropriately.</p>
<p>This actually consists of correction using up to 3 reference flat images:</p>
<ul class="simple">
<li>PFLTCORR: apply a pixel-to-pixel flat (ground flats)</li>
<li>DFLTCORR: apply a delta flat, applies any needed changes to the small-scale PFLTFILE</li>
<li>LFLTCORR: apply a low order flat, correcting for large scale sensativity variations (on-orbit)</li>
</ul>
<p>The pipeline is currently only using the P-flats. If two or more reference files are specified, they are read in line-by-line and multiplied together to form a combined flatfield correction image.</p>
<p>Subarray science images use the same reference file as the full-frame images; <cite>calwf3</cite> will extract the appropriate region from the reference file and apply it to the subarray input image.</p>
<p>The PHOTCORR step is performed using tables of precomputed values instead of calls to SYNPHOT, it uses the reference table specified in the IMPHTTAB header keyword. Each DETECTOR uses a different table.</p>
<p>If you do not wish to use this feature, set the header keyword PHOTCORR to OMIT. However, if you intend to use the FLUXCORR step, then PHOTCORR must be set to PERFORM as well.</p>
<ul class="simple">
<li>PHOTFNU: the inverse sensitivity in units of :math: Jansky sec electron^{-1}`</li>
<li>PHOTFLAM: the inverse sensistiy in units of <span class="math">\(ergs\  cm^{-2} A^{-1} electron^{-1}\)</span></li>
<li>PHOTPLAM: the bandpass pivot wavelength</li>
<li>PHOTBW: the bandpass RMS width</li>
<li>PHTFLAM1: the inverse sensistiy in units of <span class="math">\(ergs cm^{-2} A^{-1} electron^{-1}\)</span></li>
<li>PHTFLAM2: the inverse sensistiy in units of <span class="math">\(ergs cm^{-2} A^{-1} electron^{-1}\)</span></li>
</ul>
<p>For versions 3.3 and beyond, the value PHOTFNU is calculated specific for each UVIS chip, see the section on FLUXCORR for more information.</p>
<p>The SCI headers for each chip contain the PHOTFNU keyword, which is valid for its respective chip, where PHOTFNU is calculated as:</p>
<p>For UVIS 1:  <span class="math">\(photfnu = 3.33564e^{4} * PHTFLAM1 * PHOTPLAM^{2}\)</span></p>
<p>For UVIS 2:  <span class="math">\(photfnu = 3.33564e^{4} * PHTFLAM2 * PHOTPLAM^{2}\)</span></p>
<p>The IMPHTTAB file format for WFC3 UVIS is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>EXT#  FITSNAME      FILENAME              EXTVE DIMENS       BITPI OBJECT

0     z7n21066i_imp z7n21066i_imp.fits                       16
1       BINTABLE    PHOTFLAM              1     5Fx256R
2       BINTABLE    PHOTPLAM              1     5Fx256R
3       BINTABLE    PHOTBW                1     5Fx256R
4       BINTABLE    PHTFLAM1              1     5Fx256R
5       BINTABLE    PHTFLAM2              1     5Fx256R
</pre></div>
</div>
<p>where each extension contains the photometry keyword information for that specific header keyword. The rows inside the tables are split on observation mode.</p>
<p>The FLUXCORR step was added in calwf3 v3.1.2 as a way to scale the UVIS chips
so that the flux correction over both chips is uniform. This requires new keywords
which specify new PHOTFLAM values to use for each chip as well as a keyword to specify the scaling factor
for the chips. New flatfields must be used and will replace the old flatfields in CDBS but the change will
not be noticable to users. Users should be aware that flatfield images used in conjunction with v3.2.1
of the software should not be used with older versions as the data, and vice versa will be scaled incorrectly.</p>
<p>The new keywords include:</p>
<ul class="simple">
<li>PHTFLAM1: The FLAM for UVIS 1</li>
<li>PHTFLAM2: The FLAM for UVIS 2</li>
<li>PHTRATIO: The ratio: PHTFLAM2 / PHTFLAM1, which is calculated by calwf3 and is multiplied with UVIS2 (SCI,1 in the data file)</li>
</ul>
<p>In order for FLUXCORR to work properly the value of PHOTCORR must also be set to perform since this populates
the header of the data with the keywords FLUXCORR requires to compute the PHTRATIO.</p>
<p>This step is performed by default in the pipeline and the PHOTFLAM keyword will be valid for both chips after the correction has been applied.</p>
<p>IR pipeline output files using the RAW file as input:</p>
<blockquote>
<div><ul class="simple">
<li>flt.fits: output calibrated, ramp-fitted exposure produced after CRCORR has been run</li>
<li>ima.fits: output ramp calibrated exposure. Remember that the signal rate recorded in each SCI extension of the ima file represents the average flux between that particular readout and the zero read.</li>
<li>_crj.fits: a cosmic-ray rejected sub-product produced from images in an association table</li>
<li>.tra: output text information about the processing</li>
</ul>
</div></blockquote>
<div class="figure align-center" id="id20">
<span id="irflow"></span><img alt="Flow diagram for IR data using wf3ir in calwf3" src="_images/wfc3_Ch33_5.png" />
<p class="caption"><span class="caption-text">Figure 4: Flow diagram for IR data using wf3ir in calwf3</span></p>
</div>
<p>Initialize the data quality array for the image using the reference file specified in its header with BPIXTAB. The DQ array is no longer updated to reflect any TDF transition during the sample. If you want to update DQ pixel values yourself before running further processing, do it after this first step has been completed, remembering that the data in this extension is always in units of UNSIGNED INTEGER. The following table lists the DQ flag values and their meanings:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="8%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">NAME</th>
<th class="head">VALUE</th>
<th class="head">DESCRIPTION</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GOODPIXEL</td>
<td>0</td>
<td>OK</td>
</tr>
<tr class="row-odd"><td>SOFTERR</td>
<td>1</td>
<td>Reed-Solomon decoding error</td>
</tr>
<tr class="row-even"><td>DATALOST</td>
<td>2</td>
<td>data replaced by fill value</td>
</tr>
<tr class="row-odd"><td>DETECTORPROB</td>
<td>4</td>
<td>bad detector pixel or beyond aperture</td>
</tr>
<tr class="row-even"><td>DATAMASKED</td>
<td>8</td>
<td>masked by occulting bar</td>
</tr>
<tr class="row-odd"><td>BADZERO</td>
<td>8</td>
<td>deviant IR zero-read pixel</td>
</tr>
<tr class="row-even"><td>HOTPIX</td>
<td>16</td>
<td>hot pixel</td>
</tr>
<tr class="row-odd"><td>UNSTABLE</td>
<td>32</td>
<td>IR unstable pixel</td>
</tr>
<tr class="row-even"><td>WARMPIX</td>
<td>64</td>
<td>warm pixel</td>
</tr>
<tr class="row-odd"><td>BADBIAS</td>
<td>128</td>
<td>bad bias value</td>
</tr>
<tr class="row-even"><td>SATPIXEL</td>
<td>256</td>
<td>full-well or a-to-d saturated pixel</td>
</tr>
<tr class="row-odd"><td>BADFLAT</td>
<td>512</td>
<td>bad flatfield value</td>
</tr>
<tr class="row-even"><td>SPIKE</td>
<td>1024</td>
<td>CR spike detected during cridcalc IR</td>
</tr>
<tr class="row-odd"><td>ZEROSIG</td>
<td>2048</td>
<td>IR zero-read signal correction</td>
</tr>
<tr class="row-even"><td>ne TBD</td>
<td>4096</td>
<td>reserved for Multidrizzle CR rej</td>
</tr>
<tr class="row-odd"><td>DATAREJECT</td>
<td>8192</td>
<td>rejected during image combination UVIS, IR CR rejection</td>
</tr>
<tr class="row-even"><td>HIGH_CURVATURE</td>
<td>16384</td>
<td>pixel has more than max CR&#8217;s</td>
</tr>
<tr class="row-odd"><td>RESERVED2</td>
<td>32768</td>
<td>can&#8217;t use</td>
</tr>
</tbody>
</table>
<p>This step measures the signal between the super zero read in the linearity reference file (NLINFILE) and the science zero read exposure, the steps are roughly as follows:</p>
<ul class="simple">
<li>copy the zero sig image from the linearity reference file</li>
<li>compute any subarray offsets</li>
<li>subtract the super zero read reference image from the zero read science image</li>
<li>compute the noise in the zero image</li>
<li>pixels which contain more than ZTHRESH*noise of detected signal are flagged and that signal is passed to the NLINCORR step to help judge saturation and linearity, avoiding reference pixels.</li>
<li>low signal pixels are masked out by setting them to zero</li>
<li>the NLINCOR file has an extension with saturation values for each pixel which is referenced here. Pixels which are saturated in the zeroth or first reads are flagged in the DQ and the number of found saturated pixels are reported.</li>
<li>This step works poorly for bright targets which are already begining to saturate in the zeroth and first reads</li>
<li>This step acutally subtractes the super zero read from the science zero read instead of calculating an estimated signal based on the first read and zero read + estimated exposure time between them so that the difference in readout time for subarrays is not an issue.</li>
</ul>
<p>This step subtracts the bias level using the reference pixels around the perimeter of the detector, the boundries fo the reference pixels are defined in the OSCNTAB reference file. There are 5 reference pixels on each end of each row, but 1 is ignored on each side, for a total of 8 being used per row. The resistent mean of the standard deviation of all the reference pixels in the image is subtracted from the entire image and the value is stored in the MEANBLEV keyword in the output image header. The reference pixels are left in place in the IMA output image through processeing, but the final FLT image has been trimmed to just the science pixels.</p>
<p>The original zero read is subtracted form all groups in the science image, including the zeroth read itself, combining the DQ arrays with a logical OR. The ERR and SAMP arrays are unchanged and the TIME arrays are subtracted from each other. The exposure time for the group being corrected is reduced by an amount equal to the exposure time of the zero-read. At this point we&#8217;ve subtracted the mean bias using the reference pixels (BLEVCORR) and added back in the signal from the super zero read (done at the end of ZSIGCORR). What&#8217;s left in the zero read of the science image is the superbias subtracted signal. The TIME and SAMP arrays are saved to the FTL image only AFTER the CRCORR step has been completed.</p>
<p>The errors associated with the raw data are estimated according  to the noise model for the detector which currently includes a simple combination of detector readnoise and poisson noise from the pixel. Readnoise and gain are read from the CCDTAB reference file. The ERR array continues to be summed in quadrature as the SCI array is processed. Inside the final FLT image, the ERR array is calculated by CRCORR as the calculated uncertainty of the count-rate fit to the multiaccum samples.</p>
<div class="math">
\[\sigma_{IR} = \frac{\sqrt{(readnoise^{2}) + (counts * gain)}}{gain}\]</div>
<p>The integrated counts in the science images are corrected for the  non-linear response of the detectors, flagging pixels which extend into saturation (as defined in the saturation extension of the NLINFILE reference image. The observed response of the detector can be represented by two regimes:</p>
<ul class="simple">
<li>At low and intermediate signal levels the detector response deviates from the incident flux in a way that is correctable using the following expression</li>
</ul>
<div class="math">
\[F_{c} = (1 + c_{1} + c_{2} \times F + c_{3}\times F^{2} + c_{4} \times F^{3}) \times F\]</div>
<p>where c1, c2, c3, and c4 are the correction coefficients, F is the uncorrected flux in DN and <span class="math">\(F_{c}\)</span> is the corrected flux. The current form of the correction uses a third-order polynomial, but the algoritm can handle an arbitrary number of coefficients. The number of coefficients and error terms are given by the values of the NCOEFF and NERR keywords in the header of the NLINFILE.</p>
<ul class="simple">
<li>At high signal levels, as saturation sets in, the response becomes highly non-linear and is not correctable to a scientifically useful degree.</li>
</ul>
<p>The signal in the zero read is temporarily added back to the zeroth read image of the science data before the linearity correction is applied and before the saturation is judged. Once the correction has been applied the signal is once again removed. This only occurs if the ZSIGCORR step is set to PERFORM. Saturation values for each pixel are stored in the NODE extension of the NLINFILE. After each group is corrected, the routine also sets saturation flags in the next group for those pixels that are flagged as saturated in the current group. This is necessary because the SCI image value of saturated pixels will sometimes start to go back down in the subsequent reads after saturation occurs, which means they could go unflagged by normal checking techniques. The SAMP and TIME arrays are not modified during this step.</p>
<p>The format of the linearity reference file:</p>
<div class="highlight-python"><div class="highlight"><pre>EXT#  FITSNAME      FILENAME              EXTVE DIMENS       BITPI OBJECT

0     u1k1727mi_lin u1k1727mi_lin.fits                       -32
1       IMAGE       COEF                  1     1024x1024    -32
2       IMAGE       COEF                  2     1024x1024    -32
3       IMAGE       COEF                  3     1024x1024    -32
4       IMAGE       COEF                  4     1024x1024    -32
5       IMAGE       ERR                   1     1024x1024    -32
6       IMAGE       ERR                   2     1024x1024    -32
7       IMAGE       ERR                   3     1024x1024    -32
8       IMAGE       ERR                   4     1024x1024    -32
9       IMAGE       ERR                   5     1024x1024    -32
10      IMAGE       ERR                   6     1024x1024    -32
11      IMAGE       ERR                   7     1024x1024    -32
12      IMAGE       ERR                   8     1024x1024    -32
13      IMAGE       ERR                   9     1024x1024    -32
14      IMAGE       ERR                   10    1024x1024    -32
15      IMAGE       DQ                    1     1024x1024    -32
16      IMAGE       NODE                  1     1024x1024    -64
17      IMAGE       ZSCI                  1     1024x1024    -32
18      IMAGE       ZERR                  1     1024x1024    -32
</pre></div>
</div>
<p>The reference file listed under the DARKFILE header keyword is used to subtract the dark current from each sample. Due to potential non-linearities in some of the signal components, such as reet-related effecets in the first one or two reads of an exposure, the dark current subtraction is not aplied by simply scaling a generic reference dark image to the exposure time and then subtracting it. Instead, a library of dark current images is maintained that includes darks taken in each of the available predefined multiaccum sample sequences, as well as the available sub-array readout modes. The multiaccum dark reference file is subtracted read-by-read from the stack of science image readouts so that there is an exact match in the timings and other characteristics of the dark image and the science image. The subtraction does not include the reference pixel. The ERR and DQ arrays from the reference dark file are combined with the SCI and DQ arrays from the science image, but the SAMP and TIME arrays are unchanged. The mean of the dark image is saved to the MEANDARK keyword in the output science image header.</p>
<p>The PHOTCORR step is performed using tables of precomputed values instead of calls  to SYNPHOT. The correct table for a given image must be specified in the IMPHTTAB header keyword in order for calwf3 to perform the PHOTCORR step. The format of the file for the IR detectors is:</p>
<div class="highlight-python"><div class="highlight"><pre>EXT#  FITSNAME      FILENAME              EXTVE DIMENS       BITPI OBJECT

0     wbj1825ri_imp wbj1825ri_imp.fits                       16
1       BINTABLE    PHOTFLAM              1     5Fx38R
2       BINTABLE    PHOTPLAM              1     5Fx38R
3       BINTABLE    PHOTBW                1     5Fx38R
</pre></div>
</div>
<p>where each extension contains the photometry keyword information for that specific header keyword. The rows in the tables are split on observation mode.</p>
<ul class="simple">
<li>PHOTFLAM: the inverse sensistiy in units of <span class="math">\(ergs\ cm^{-2} A^{-1} electron^{-1}\)</span></li>
<li>PHOTPLAM: the bandpass pivot wavelength</li>
<li>PHOTBW: the bandpass RMS width</li>
</ul>
<p>This step converts the science data from a time-integrated signal to a signal rate by dividing the SCI and ERR arrays for reach readout by the TIME array. No reference file is needed. The BUNIT keyword in the output data header reflects the appropriate data units. The FLATCORR keyword is checked to decide on  proper units for BUNIT and skip this step if &#8220;countrate&#8221; is found. If FLATCORR is set to &#8220;complete&#8221;, then the units should be electrons, otherwise they are counts(the digitized signal from the FPA).</p>
<p>This step fits the accumulating signal up the image ramp and identifies cosmic-ray hits for each sample using the <a class="reference external" href="http://adsabs.harvard.edu/abs/2000PASP..112.1350F">Fixsen et al (2000)</a>  methods.</p>
<p>The process is described below:</p>
<ul>
<li><dl class="first docutils">
<dt>An iterative fit to the accumulating sample time is calculated for each pixel</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Finding a cosmic ray ends one interval and beins the next; the cosmic ray must be included in the next interval</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>intervals are first defined based on existing cosmic rays</dt>
<dd><ul class="first last simple">
<li>CRSIGMAS from the  CRREJTAB reference file is used to set the rejection threshold</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">then each interval is fitted separately</p>
</li>
<li><p class="first">then each interval is inspected for SPIKES</p>
</li>
<li><p class="first">then each interval is inspected for more cosmic rays</p>
</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">If any SPIKES or cosmic rays are found then the entire procedure repeats, new intervals are defined, etc ...</p>
</li>
<li><p class="first">After the iteration ends because no new SPIKES or cosmic rays are found, each interval is fitted separately once again, with optimum weighting, and then the results for each interval are combined to obtain  the final solution for the pixel.</p>
</li>
<li><p class="first">The linearity fit includes readnoise in the sample weights and Poisson noise from the source in the final fit uncertainty</p>
</li>
<li><p class="first">negative cosmic ray hits are detected and detected SPIKES have their 1024 bit flipped in the DQ extension</p>
</li>
<li><dl class="first docutils">
<dt>If the first read is saturated the output pixels are never zeroed out</dt>
<dd><ul class="first last simple">
<li>The output pixel values in this case are the value in the input zeroth read image, regardless of whether the zero-read image was saturated. If it is saturated in the zero-read, the DQ flag will get carried over to the outpu DQ array to indicate that it&#8217;s bad.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">The DATAREJECT DQ flag is set for all samples following a hit. This is done so that anyone looking at the IMA file will know that the absolute value of the pixel is wrong after the firs t hit, but it smears the location of any hits which occurred in addition to the first one.</p>
</li>
<li><p class="first">Pixels in the DQ image of the output IMA file are flagged with a value of 8192, the SCI and ERR image arrays are left unchanged</p>
</li>
<li><p class="first">DQ values from any sample are carried through to the output pixel if a pixel has no good samples</p>
</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">The UNSTABLE DQ flag is used to record pixels with higher than max allowed cosmic ray hits recorded.</p>
</li>
</ul>
<p>The result of this step  is stored as a single imset in the output FLT file. In the FLT file, the SCI array contains the final slope computed for each pixel, the ERR array contains the estimated uncertainty in the slope, the SAMP array contains the number of non-flagged samples used to compute the slope, and the TIME array contains the total exposure time of those smaples. Pixels for which no unflagged sample exisists (dead pixels for example) still get a slope computed which is recorded in the SCI array of the output FLT image, but the DQ flags in the FLT will reflect their bad status.</p>
<p>This step corrects for sensativity variations across the detector by dividing the images by one or more reference flatfields (taken from the PFLTFILE, DFLTFILE or LFLTFILE header keywords). The mean gain from all the amps is used to convert to the image to units of electrons. Errors and DQ flags from the flatfields are combined with the science data errors and flag, the TIME and SAMP arrays are unchanged.</p>
<p>The min, mean, maxmin and max SNR (for the SCI and ERR) for data values flagged as &#8220;good&#8221; in the DQ array (i.e. zero) are calculated and stored in the output SCI image header, the reference pixels are not used. This is performed for all samples in the IMA file as well as the FLT image but the input data is not modified in any way. Updated keywords in the science header include:</p>
<ul class="simple">
<li>NGOODPIX</li>
<li>GOODMEAN</li>
<li>GOODMIN</li>
<li>GOODMAX</li>
<li>SNRMEAN</li>
<li>SNRMIN</li>
<li>SNRMAX</li>
</ul>
<p>Reject cosmic rays from multiple images. CR-SPLIT and REPEAT-OBS exposures get combined, other members of the association file must be combined with Astrodrizzle  (see <a class="reference external" href="http://www.stsci.edu/hst/HST_overview/drizzlepac/">Astrodrizzle</a> ), which will also correct for geometric distortion. This step is also referred to as <a class="reference internal" href="wf3rej.html#wf3rej"><span>wf3rej</span></a>. The task uses the same statistical detection algorithm developed for ACS (acsrej), STIC (ocrrj) and WFPC2(crrej), providing a well-tested and robust procedure.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.calwf3.getHelpAsString">
<code class="descclassname">wfc3tools.calwf3.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.calwf3.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Return documentation on the &#8216;wf3ir&#8217; function. Required by TEAL.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.calwf3.help">
<code class="descclassname">wfc3tools.calwf3.</code><code class="descname">help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.calwf3.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.calwf3.run">
<code class="descclassname">wfc3tools.calwf3.</code><code class="descname">run</code><span class="sig-paren">(</span><em>configobj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.calwf3.run" title="Permalink to this definition">¶</a></dt>
<dd><p>TEAL interface for the &#8216;calwf3&#8217; function.</p>
</dd></dl>

</div>
<div class="section" id="module-wfc3tools.embedsub">
<span id="wfc3tools-embedsub-module"></span><h2>wfc3tools.embedsub module<a class="headerlink" href="#module-wfc3tools.embedsub" title="Permalink to this headline">¶</a></h2>
<p>embedsub Version 1.3.1  updated on  10-Jan-2014</p>
<div class="section" id="embedsub">
<span id="id3"></span><h3>embedsub<a class="headerlink" href="#embedsub" title="Permalink to this headline">¶</a></h3>
<p>Given an image specified by the user which contains a subarray readout, return a full-frame image with the subarray implanted at the appropriate location.</p>
<div class="section" id="usage">
<h4>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">embedsub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">embedsub</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>files [file]</dt>
<dd>Input image name or list of image names. The rootname will be used to create the output name</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="returns">
<h4>Returns<a class="headerlink" href="#returns" title="Permalink to this headline">¶</a></h4>
<p>Return the full-frame location of the subarray coordinates using a  file specified by the user.</p>
</div>
<div class="section" id="example-output">
<h4>Example Output<a class="headerlink" href="#example-output" title="Permalink to this headline">¶</a></h4>
<p>This method calls wfc3tools.sub2full to calculation the subarray position on the full frame image.</p>
<p>This is the default output:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; wfc3tools.embedsub.embedsub(&#39;ic5p02eeq_flt.fits&#39;)
&gt; Subarray image section [x1,x2,y1,y2] = [2828:3339,215:726]
&gt; Image saved to: ic5p02eef_flt.fits
</pre></div>
</div>
<dl class="function">
<dt id="wfc3tools.embedsub.embedsub">
<code class="descclassname">wfc3tools.embedsub.</code><code class="descname">embedsub</code><span class="sig-paren">(</span><em>files</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.embedsub.embedsub" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full-frame location of the subarray coordinates using a  file specified by the user.</p>
<dl class="docutils">
<dt>filename <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>The name of the image file containing the subarray. This can be a single filename or a list of files.
The ippsoot will be used to construct the output filename. You should input an FLT image</dd>
</dl>
<p>The output file will contain the subarray image placed inside the full frame extent of a regular image</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.embedsub.getHelpAsString">
<code class="descclassname">wfc3tools.embedsub.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.embedsub.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns documentation on the &#8216;embedsub&#8217; function.</p>
<p>return useful help from a file in the script directory called
__taskname__.help</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.embedsub.help">
<code class="descclassname">wfc3tools.embedsub.</code><code class="descname">help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.embedsub.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
</div>
<div class="section" id="module-wfc3tools.pstack">
<span id="wfc3tools-pstack-module"></span><h2>wfc3tools.pstack module<a class="headerlink" href="#module-wfc3tools.pstack" title="Permalink to this headline">¶</a></h2>
<p>pstack Version 1.3.1  updated on  06-Sep-2013</p>
<div class="section" id="pstack">
<span id="id4"></span><h3>pstack<a class="headerlink" href="#pstack" title="Permalink to this headline">¶</a></h3>
<p>Plot the stack of MultiAccum sample values for a specified pixel  in an
IR multiaccum image.  Pixels from any of the SCI, ERR, DQ, or TIME image 
extensions can be plotted.  The total number  of
samples  is determined from the primary header keyword NSAMP and all
samples (excluding the zeroth read) are plotted.  The SCI, ERR,  DQ,
values are plotted as a function of sample time, while TIME
values are plotted as a  function  of  sample  number.   The  sample
times  are read from the SAMPTIME keyword in the SCI header for each
readout. If any of the ERR, DQ, SAMP, or TIME extensions have  null
data  arrays,  the value of the PIXVALUE extension header keyword is
substituted for the pixel values.  The plotted data  values  can  be
saved to an output text table or printed to the terminal.</p>
<p>The BUNIT keyword value is used to determine the starting units of the data,
but you can plot either counts or rate using the optional keyword <code class="docutils literal"><span class="pre">units</span></code>.</p>
<div class="figure align-center">
<img alt="_images/pstack_example.png" src="_images/pstack_example.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre>In [1]: xdata,ydata=pstack.pstack(&#39;ibh719grq_ima.fits&#39;,column=100,row=25,extname=&#39;sci&#39;)
</pre></div>
</div>
<p>The plotting data is returned as two arrays, to save them into variables issue the command as above:</p>
<div class="highlight-python"><div class="highlight"><pre>In [1]: xdata
Out[2]: 
array([ 100.651947,   93.470573,   86.2892  ,   79.107826,   71.926453,
         64.745079,   57.563702,   50.382328,   43.200954,   36.019581,
         28.838205,   21.65683 ,   14.475455,    7.29408 ,    0.112705,
          0.      ])

In [3]: ydata
Out[4]: 
array([ 221.36606389,  219.5396653 ,  182.63100095,  169.178308  ,
        186.44084352,  158.3105126 ,  129.46997895,  129.92935701,
        106.14521852,   72.71721539,   69.68652119,   55.98828663,
         42.30755279,   13.12659422,   27.71404187,    0.        ])
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Note that the arrays are structured in SCI order, so the final exposure is the first element in the array</p>
</div>
<div class="section" id="id5">
<h4>Parameters<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<ul>
<li><dl class="first docutils">
<dt>input [file]</dt>
<dd><p class="first last">Input MultiAccum image name.  This should be either  a  _ima  or _raw  file, containing all the data from multiple readouts.  You must specify just the file name, with no extension designation.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>col [integer]</dt>
<dd><p class="first last">The column index of the pixel to be plotted.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>row [integer]</dt>
<dd><p class="first last">The row index of the pixel to be plotted.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>extname = &#8220;sci&#8221; [string, allowed values: sci | err | dq | samp | time]</dt>
<dd><p class="first last">Extension name (EXTNAME keyword value) of data to plot.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>units = &#8220;counts&#8221; [string, allowed values: counts | rate]</dt>
<dd><p class="first last">Plot &#8220;sci&#8221; or  &#8220;err&#8221;  data  in  units  of  counts  or  countrate (&#8220;rate&#8221;).   Input data can be in either unit; conversion will be performed automatically.  Ignored when  plotting  &#8220;dq&#8221;,  &#8220;samp&#8221;, or &#8220;time&#8221; data.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>title = &#8220;&#8221; [string]</dt>
<dd><p class="first last">Title  for  the  plot.   If  left  blank,  the name of the input image, appended with  the  extname  and  column  and  row  being plotted, is used.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>xlabel = &#8220;&#8221; [string]</dt>
<dd><p class="first last">Label  for  the  X-axis  of the plot.  If left blank, a suitable default is generated.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>ylabel = &#8220;&#8221; [string]</dt>
<dd><p class="first last">Label for the Y-axis of the plot.  If  left  blank,  a  suitable default  based  on the plot units and the extname of the data is generated.</p>
</dd>
</dl>
</li>
<li><p class="first">plot = True [bool]  set plot to false if you only want the data returned</p>
</li>
</ul>
</div>
<div class="section" id="id6">
<h4>Usage<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">pstack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="o">=</span><span class="n">pstack</span><span class="p">(</span><span class="n">inputFilename</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">extname</span><span class="o">=</span><span class="s2">&quot;sci&quot;</span><span class="p">,</span><span class="n">units</span><span class="o">=</span><span class="s2">&quot;counts|rate&quot;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="function">
<dt id="wfc3tools.pstack.getHelpAsString">
<code class="descclassname">wfc3tools.pstack.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.pstack.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns documentation on the &#8216;sampinfo&#8217; function.</p>
<p>return useful help from a file in the script directory called
__taskname__.help</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.pstack.help">
<code class="descclassname">wfc3tools.pstack.</code><code class="descname">help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.pstack.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.pstack.pstack">
<code class="descclassname">wfc3tools.pstack.</code><code class="descname">pstack</code><span class="sig-paren">(</span><em>filename</em>, <em>column=0</em>, <em>row=0</em>, <em>extname='sci'</em>, <em>units='counts'</em>, <em>title=None</em>, <em>xlabel=None</em>, <em>ylabel=None</em>, <em>plot=True</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.pstack.pstack" title="Permalink to this definition">¶</a></dt>
<dd><p>A function  to plot the statistics of one pixels up the IR ramp  image
Original implementation in the iraf nicmos package. Pixel values here are 0 based, not 1 based</p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-wfc3tools.pstat">
<span id="wfc3tools-pstat-module"></span><h2>wfc3tools.pstat module<a class="headerlink" href="#module-wfc3tools.pstat" title="Permalink to this headline">¶</a></h2>
<p>pstat Version 1.3.1  updated on  26-Sep-2013</p>
<div class="section" id="pstat">
<span id="id7"></span><h3>pstat<a class="headerlink" href="#pstat" title="Permalink to this headline">¶</a></h3>
<p>Plot statistics for a specified image section  up  the  stack  of  a
an IR MultiAccum image.  Sections from any of the SCI,
ERR, DQ,  image extensions can be  plotted.   A  choice
of  mean,  median,  mode,  standard  deviation,  minimum and maximum
statistics is available.  The total number of samples is  determined
from  the  primary  header  keyword NSAMP and all samples (excluding
the zeroth-read) are plotted.  The SCI, ERR, DQ  statistics
are  plotted as a function of sample time. The sample times  are  read
from  the  SAMPTIME  keyword in the SCI header for each readout.</p>
<p>SAMP and TIME aren&#8217;t generally populated until the FLT image stage
To plot the samptime vs sample, use wfc3tools.pstat and the &#8220;time&#8221; extension</p>
<div class="figure align-center" id="id21">
<img alt="pstat example plot" src="_images/pstat_example.png" />
<p class="caption"><span class="caption-text">Figure 6: An example of the default plot from pstat</span></p>
</div>
<div class="highlight-python"><div class="highlight"><pre>In [1]: pstat(&#39;ibh719grq_ima.fits&#39;)
</pre></div>
</div>
<p>The plotting data is returned as two arrays:</p>
<div class="highlight-python"><div class="highlight"><pre>Out[2]: 
(array([ 100.651947,   93.470573,   86.2892  ,   79.107826,   71.926453,
          64.745079,   57.563702,   50.382328,   43.200954,   36.019581,
          28.838205,   21.65683 ,   14.475455,    7.29408 ,    0.112705,
           0.      ]),
 array([ 171.85813415,  162.44643275,  148.99918831,  137.60458714,
         125.91510743,  114.71149769,  102.63038466,   90.97130078,
          78.26479365,   67.16825321,   53.6897243 ,   41.71639092,
          29.36628817,   16.47151355,   -0.20821257,    0.        ]))
</pre></div>
</div>
<p>If you want to save the plotting data into the variables <code class="docutils literal"><span class="pre">time</span></code> and <code class="docutils literal"><span class="pre">counts</span></code> you can issue the command like this:</p>
<div class="highlight-python"><div class="highlight"><pre>In [1]: time,counts =pstat.pstat(&#39;ibh719grq_ima.fits&#39;)

In [2]: time
Out[3]: 
array([ 100.651947,   93.470573,   86.2892  ,   79.107826,   71.926453,
         64.745079,   57.563702,   50.382328,   43.200954,   36.019581,
         28.838205,   21.65683 ,   14.475455,    7.29408 ,    0.112705,
          0.      ])

In [4]: counts
Out[5]: 
array([ 171.85813415,  162.44643275,  148.99918831,  137.60458714,
        125.91510743,  114.71149769,  102.63038466,   90.97130078,
         78.26479365,   67.16825321,   53.6897243 ,   41.71639092,
         29.36628817,   16.47151355,   -0.20821257,    0.        ])
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Note that the arrays are structured in SCI order, so the final exposure is the first element in the array</p>
</div>
<div class="section" id="id8">
<h4>Parameters<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<ul>
<li><dl class="first docutils">
<dt>filename [file]</dt>
<dd><p class="first last">Input   MultiAccum   image  name  with  optional  image  section  specification.  If no image section  is  specified,  the  entire image  is  used.   This  should  be  either a _raw or _ima file, containing all  the  data  from  multiple  readouts.   You  must specify  just  the  file name and image section, with no extname designation.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>extname = &#8220;sci&#8221; [string, allowed values: sci | err | dq ]</dt>
<dd><p class="first last">Extension name (EXTNAME keyword value) of data to plot.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>units = &#8220;counts&#8221; [string, allowed values: counts | rate]</dt>
<dd><p class="first last">Plot &#8220;sci&#8221; or  &#8220;err&#8221;  data  in  units  of  counts  or  countrate
(&#8220;rate&#8221;).   Input data can be in either unit; conversion will be
performed automatically.  Ignored when  plotting  &#8220;dq&#8221;,  &#8220;samp&#8221;,
or &#8220;time&#8221; data.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>stat = &#8220;midpt&#8221; [string, allowed values: mean|midpt|mode|stddev|min|max]</dt>
<dd><p class="first last">Type of statistic to compute.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>title = &#8220;&#8221; [string]</dt>
<dd><p class="first last">Title  for  the  plot.   If  left  blank,  the name of the input
image, appended with the extname and image section, is used.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>xlabel = &#8220;&#8221; [string]</dt>
<dd><p class="first last">Label for the X-axis of the plot.  If  left  blank,  a  suitable
default is generated.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>ylabel = &#8220;&#8221; [string]</dt>
<dd><p class="first last">Label  for  the  Y-axis  of  the plot. If left blank, a suitable
default based on the plot units and the extname of the  data  is
generated.</p>
</dd>
</dl>
</li>
<li><p class="first">plot = True [bool]  set plot to false if you only want the data returned</p>
</li>
</ul>
</div>
<div class="section" id="id9">
<h4>Usage<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre>pstat.py  inputFilename [pixel range]


&gt;&gt;&gt; python
&gt;&gt;&gt; from wfc3tools import pstat
&gt;&gt;&gt; pstat(inputFilename,extname=&quot;sci&quot;,units=&quot;counts&quot;,stat=&quot;midpt&quot;,title=&quot;&quot;,xlabel=&quot;&quot;,ylabel=&quot;&quot; )
</pre></div>
</div>
<dl class="function">
<dt id="wfc3tools.pstat.getHelpAsString">
<code class="descclassname">wfc3tools.pstat.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.pstat.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns documentation on the &#8216;sampinfo&#8217; function.</p>
<p>return useful help from a file in the script directory called
__taskname__.help</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.pstat.help">
<code class="descclassname">wfc3tools.pstat.</code><code class="descname">help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.pstat.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.pstat.pstat">
<code class="descclassname">wfc3tools.pstat.</code><code class="descname">pstat</code><span class="sig-paren">(</span><em>filename</em>, <em>extname='sci'</em>, <em>units='counts'</em>, <em>stat='midpt'</em>, <em>title=None</em>, <em>xlabel=None</em>, <em>ylabel=None</em>, <em>plot=True</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.pstat.pstat" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to plot the statistics of one or more pixels up the IR ramp  image
Original implementation in the iraf nicmos package. Pixel values here are 0 based, not 1 based</p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-wfc3tools.sampinfo">
<span id="wfc3tools-sampinfo-module"></span><h2>wfc3tools.sampinfo module<a class="headerlink" href="#module-wfc3tools.sampinfo" title="Permalink to this headline">¶</a></h2>
<p>sampinfo Version 1.3.1  updated on  Sep-16-2013</p>
<div class="section" id="sampinfo">
<span id="id10"></span><h3>sampinfo<a class="headerlink" href="#sampinfo" title="Permalink to this headline">¶</a></h3>
<p>Sampinfo prints information about a  WFC3/IR  MultiAccum image,  including  exposure  time  information  for  the  individual samples (readouts).  
The global information listed  (and  the  names of  the  header  keywords  from  which it is retrieved) includes:</p>
<ul class="simple">
<li>the total number of image extensions in the file (NEXTEND)</li>
<li>the name  of the  MultiAccum  exposure  sample  sequence  (SAMP_SEQ)</li>
<li>the  total number of samples, including the  &#8220;zeroth&#8221;  read  (NSAMP)</li>
<li>the total  exposure  time of the observation (EXPTIME).</li>
</ul>
<p>Information that is listed for each sample is the IMSET number (EXTVER),  the  sample number  (SAMPNUM),  the  sample time, which is the total accumulated exposure time for a sample (SAMPTIME), 
and the delta time, which  is the  additional  exposure time accumulated since the previous sample (DELTATIM).</p>
<p>Note that the samples of a MultiAccum exposure  are  stored  in  the FITS  file  in  reverse  time  order. The initial, or &#8220;zeroth&#8221; read, appears  last  in  the  FITS  file,  
with  IMSET=NSAMP,   SAMPNUM=0, SAMPTIME=0,  and  DELTATIM=0. The final read of the exposure appears first in the file  and  has  IMSET=1,  SAMPNUM=NSAMP-1  (SAMPNUM  is zero-indexed), and SAMPTIME=EXPTIME.</p>
<div class="section" id="options">
<h4>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>This version will accept a single image name or a python list of images. The list of images should be a python style list, such as:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="s2">&quot;image1.fits&quot;</span><span class="p">,</span><span class="s2">&quot;image2.fits&quot;</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
<p>add_keys=list(): You can also supply a supplimental list of keywords to print for each sample, if the key isn&#8217;t found in the sample the global header will be checked.If a key is not found the &#8220;NA&#8221; string will be printed. 
Additionally you can ask for the median or mean of the datavalues for each sample  using the appropriate switch.</p>
<p>median=False: Set to True in order to report the median pixel value for each sample</p>
<p>mean=False: Set to True in order to report the mean pixel value for each sample (as measured with np.min and np.max)</p>
</div>
<div class="section" id="id11">
<h4>Usage<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>Typical:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">sampinfo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampinfo</span><span class="p">(</span><span class="n">imagename</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Where imagename can be a single filename or a python list() of names</p>
<dl class="docutils">
<dt>To get the median value for each sample:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sampinfo</span><span class="o">.</span><span class="n">sampinfo</span><span class="p">(</span><span class="n">imagename</span><span class="p">,</span> <span class="n">median</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>To print additional keys for information:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sampinfo</span><span class="o">.</span><span class="n">sampinfo</span><span class="p">(</span><span class="n">imagename</span><span class="p">,</span><span class="n">add_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DETECTOR&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd>
<dt>To get the average balue for each sample:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sampinfo</span><span class="o">.</span><span class="n">sampinfo</span><span class="p">(</span><span class="n">imagename</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="id12">
<h4>Example Output<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>Default output:</p>
<div class="highlight-python"><div class="highlight"><pre>In [3]: wfc3tools.sampinfo(&#39;ibcf02faq_raw.fits&#39;)
IMAGE                       NEXTEND SAMP_SEQ        NSAMP   EXPTIME
ibcf02faq_raw.fits  80      STEP50          16      499.234009

IMSET       SAMPNUM SAMPTIME        DELTATIM
1   15      499.234009      50.000412
2   14      449.233582      50.000412
3   13      399.233154      50.000412
4   12      349.232727      50.000412
5   11      299.2323        50.000412
6   10      249.231873      50.000412
7   9       199.231461      50.000412
8   8       149.231049      50.000412
9   7       99.230637       50.000412
10  6       49.230225       25.000511
11  5       24.229715       12.500551
12  4       11.729164       2.932291
13  3       8.796873        2.932291
14  2       5.864582        2.932291
15  1       2.932291        2.932291
16  0       0.0     0.0
</pre></div>
</div>
<p>with median=True:</p>
<div class="highlight-python"><div class="highlight"><pre>In [4]: wfc3tools.sampinfo(&#39;ibcf02faq_raw.fits&#39;,median=True)
IMAGE                       NEXTEND SAMP_SEQ        NSAMP   EXPTIME
ibcf02faq_raw.fits  80      STEP50          16      499.234009

IMSET       SAMPNUM SAMPTIME        DELTATIM
1   15      499.234009      50.000412       MedPixel: 11384.0
2   14      449.233582      50.000412       MedPixel: 11360.0
3   13      399.233154      50.000412       MedPixel: 11335.0
4   12      349.232727      50.000412       MedPixel: 11309.0
5   11      299.2323        50.000412       MedPixel: 11283.0
6   10      249.231873      50.000412       MedPixel: 11256.0
7   9       199.231461      50.000412       MedPixel: 11228.0
8   8       149.231049      50.000412       MedPixel: 11198.0
9   7       99.230637       50.000412       MedPixel: 11166.0
10  6       49.230225       25.000511       MedPixel: 11131.0
11  5       24.229715       12.500551       MedPixel: 11111.0
12  4       11.729164       2.932291        MedPixel: 11099.0
13  3       8.796873        2.932291        MedPixel: 11097.0
14  2       5.864582        2.932291        MedPixel: 11093.0
15  1       2.932291        2.932291        MedPixel: 11090.0
16  0       0.0     0.0     MedPixel: 11087.0
</pre></div>
</div>
<dl class="function">
<dt id="wfc3tools.sampinfo.getHelpAsString">
<code class="descclassname">wfc3tools.sampinfo.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.sampinfo.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns documentation on the &#8216;sampinfo&#8217; function.</p>
<p>return useful help from a file in the script directory called
__taskname__.help</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.sampinfo.help">
<code class="descclassname">wfc3tools.sampinfo.</code><code class="descname">help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.sampinfo.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.sampinfo.sampinfo">
<code class="descclassname">wfc3tools.sampinfo.</code><code class="descname">sampinfo</code><span class="sig-paren">(</span><em>imagelist</em>, <em>add_keys=None</em>, <em>mean=False</em>, <em>median=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.sampinfo.sampinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>The input can be a single image or list of images, add_keys should be a list() of additional keys</p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-wfc3tools.sub2full">
<span id="wfc3tools-sub2full-module"></span><h2>wfc3tools.sub2full module<a class="headerlink" href="#module-wfc3tools.sub2full" title="Permalink to this headline">¶</a></h2>
<p>sub2full Version 1.3.1  updated on  19-Nov-2013</p>
<div class="section" id="sub2full">
<h3>sub2full<a class="headerlink" href="#sub2full" title="Permalink to this headline">¶</a></h3>
<p>Given an image specified by the user which contains a subarray readout, return the location of the corner of the subarray in a full frame reference image (including the full physical extent of the chip), in 1-indexed pixels. If the user supplies an X and Y coordinate, then the translated location of that point will be returned.</p>
<div class="figure align-center">
<img alt="_images/sub2full_translate.png" src="_images/sub2full_translate.png" />
</div>
<div class="section" id="id13">
<h4>Usage<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">sub2full</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span><span class="o">=</span><span class="n">sub2full</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">fullExtent</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h4>Parameters<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<ul>
<li><dl class="first docutils">
<dt>filename [file]</dt>
<dd><p class="first last">Input image name or list of image names. The rootname will be used to find the _SPT files in the same directory, the SPT file has all the necessary information for the transform.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>x = None [integer] Optional</dt>
<dd><p class="first last">Specify an x coordinate in the subarray to translate. If an x and y are specified, the fullExtent option is turned off and only the translated x,y coords are returned</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>y = None [integer] Optional</dt>
<dd><p class="first last">Specify a y coordinate in the subarray to translate. If an x and y are specified, the fullExtent option is turned off and only the translated x,y coords are returned</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>fullExtent = False [bool] Optional</dt>
<dd><p class="first last">If set, the returned values will include the full extent of the subarray in the reference image, for example: (x0,x1,y0,y1)</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="id15">
<h4>Returns<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>A list of tuples which specify the translated coordinates, either (x0,y0) for each image or the full extent sections</p>
</div>
<div class="section" id="id16">
<h4>Example Output<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>Default output:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; sub2full(&#39;ibbso1fdq_flt.fits&#39;)
&gt; [(3584.0, 1539)]
</pre></div>
</div>
<p>Optional output:</p>
<div class="highlight-python"><div class="highlight"><pre>Specify a list of images:

&gt;im = [&#39;ic5p02e0q_spt.fits&#39;,
       &#39;ic5p02e1q_spt.fits&#39;,
       &#39;ic5p02e2q_spt.fits&#39;,
       &#39;ic5p02e3q_spt.fits&#39;,
       &#39;ic5p02e4q_spt.fits&#39;]
&gt;
&gt; sub2full(im)
&gt; [(1062.0, 1363),
&gt; (1062.0, 1363),
&gt; (1410.0, 1243),
&gt; (1410.0, 1243),
&gt; (1402.0, 1539)]


Return the full extent of the subarray:

&gt; sub2full(&#39;ibbso1fdq_flt.fits&#39;,fullExtent=True)
&gt; [(3584.0, 4096, 1539, 2050)]
</pre></div>
</div>
</div>
<div class="section" id="more-information-on-header-keywords">
<h4>More information on header keywords<a class="headerlink" href="#more-information-on-header-keywords" title="Permalink to this headline">¶</a></h4>
<p>The task uses header keywords from the SPT file of the associated image in order to calculate the offset for the subarray.
The keywords it uses are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Keyword</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>SS_DTCTR</td>
<td>To get the detector for the image</td>
</tr>
<tr class="row-odd"><td>SS_SUBAR</td>
<td>To make sure the image is a subarray</td>
</tr>
<tr class="row-even"><td>XCORNER</td>
<td>The x corner of the subarray</td>
</tr>
<tr class="row-odd"><td>YCORNER</td>
<td>The y corner of the subarray</td>
</tr>
<tr class="row-even"><td>NUMROWS</td>
<td>Subarray x size</td>
</tr>
<tr class="row-odd"><td>NUMCOLS</td>
<td>Subarray y size</td>
</tr>
</tbody>
</table>
<p>The  UVIS full frame detector has 2051 rows, with 25 pixels of serial overscan. The IR detector has 1024 rows and 5 pixels of overscan.</p>
<dl class="function">
<dt id="wfc3tools.sub2full.getHelpAsString">
<code class="descclassname">wfc3tools.sub2full.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.sub2full.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns documentation on the &#8216;sub2full&#8217; function.</p>
<p>return useful help from a file in the script directory called
__taskname__.help</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.sub2full.help">
<code class="descclassname">wfc3tools.sub2full.</code><code class="descname">help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.sub2full.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.sub2full.sub2full">
<code class="descclassname">wfc3tools.sub2full.</code><code class="descname">sub2full</code><span class="sig-paren">(</span><em>filename</em>, <em>x=None</em>, <em>y=None</em>, <em>fullExtent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.sub2full.sub2full" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full-frame location of the subarray coordinates using a  file specified by the user.</p>
<dl class="docutils">
<dt>filename <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><blockquote class="first">
<div>The name of the image file containing the subarray. This can be a single filename or a list of files.
The ippsoot will be used to reference the files SPT file headers</div></blockquote>
<dl class="last docutils">
<dt>x <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>input x position to translate, will return x0 otherwise
if x and y are specified the fullExtent option is turned off</dd>
<dt>y <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>input y position to translate, will return y0 otherwise
if x and y are specified the fullExtent option is turned off</dd>
<dt>fullExtent: bool, optional</dt>
<dd>return the full extent of the subarray in the raw frame (x0,x1, y0,y1)
This option will only work with the default specification of the corner, x0,y0</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-wfc3tools.util">
<span id="wfc3tools-util-module"></span><h2>wfc3tools.util module<a class="headerlink" href="#module-wfc3tools.util" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="wfc3tools.util.display_help">
<code class="descclassname">wfc3tools.util.</code><code class="descname">display_help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.util.display_help" title="Permalink to this definition">¶</a></dt>
<dd><p>display local html help in a browser window</p>
</dd></dl>

</div>
<div class="section" id="module-wfc3tools.version">
<span id="wfc3tools-version-module"></span><h2>wfc3tools.version module<a class="headerlink" href="#module-wfc3tools.version" title="Permalink to this headline">¶</a></h2>
<p>This is an automatically generated file created by stsci.distutils.hooks.version_setup_hook.
Do not modify this file by hand.</p>
</div>
<div class="section" id="module-wfc3tools.wf32d">
<span id="wfc3tools-wf32d-module"></span><h2>wfc3tools.wf32d module<a class="headerlink" href="#module-wfc3tools.wf32d" title="Permalink to this headline">¶</a></h2>
<p>wf32d processes UVIS images</p>
<dl class="function">
<dt id="wfc3tools.wf32d.getHelpAsString">
<code class="descclassname">wfc3tools.wf32d.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf32d.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Return documentation on the &#8216;wf3ir&#8217; function. Required by TEAL.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf32d.help">
<code class="descclassname">wfc3tools.wf32d.</code><code class="descname">help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf32d.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.wf32d.run">
<code class="descclassname">wfc3tools.wf32d.</code><code class="descname">run</code><span class="sig-paren">(</span><em>configobj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf32d.run" title="Permalink to this definition">¶</a></dt>
<dd><p>TEAL interface for the <code class="docutils literal"><span class="pre">wf32d</span></code> function.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf32d.wf32d">
<code class="descclassname">wfc3tools.wf32d.</code><code class="descname">wf32d</code><span class="sig-paren">(</span><em>input</em>, <em>output=''</em>, <em>dqicorr='PERFORM'</em>, <em>darkcorr='PERFORM'</em>, <em>flatcorr='PERFORM'</em>, <em>shadcorr='PERFORM'</em>, <em>photcorr='PERFORM'</em>, <em>verbose=False</em>, <em>quiet=True</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf32d.wf32d" title="Permalink to this definition">¶</a></dt>
<dd><p>wf32d Version 1.3.1  updated on  03-Jan-2013</p>
<p>Use this function to facilitate batch runs or for the TEAL interface.</p>
<dl class="docutils">
<dt>The wf32d primary functions include:</dt>
<dd><ul class="first last simple">
<li>DARKCORR: dark current subtraction</li>
<li>FLATCORR: flat-fielding</li>
<li>PHOTCORR: photometric keyword calculations</li>
<li>FLUXCORR: photometric normalization of the UVIS1 and UVIS2 chips</li>
</ul>
</dd>
</dl>
<p>Only those steps with a switch value of PERFORM in the input files will be executed, after which the switch
will be set to COMPLETE in the corresponding output files.</p>
<blockquote>
<div><p>In Python without TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf32d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf32d</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>In Python with TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stsci.tools</span> <span class="kn">import</span> <span class="n">teal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf32d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teal</span><span class="o">.</span><span class="n">teal</span><span class="p">(</span><span class="s1">&#39;wf32d&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In Pyraf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wfc3tools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epar</span> <span class="n">wf32d</span>
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><dl class="docutils">
<dt>input <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Name of input files</p>
<blockquote class="last">
<div><ul class="simple">
<li>a single filename (<code class="docutils literal"><span class="pre">iaa012wdq_raw.fits</span></code>)</li>
<li>a Python list of filenames</li>
<li>a partial filename with wildcards (<code class="docutils literal"><span class="pre">\*raw.fits</span></code>)</li>
<li>filename of an ASN table (<code class="docutils literal"><span class="pre">\*asn.fits</span></code>)</li>
<li>an at-file (<code class="docutils literal"><span class="pre">&#64;input</span></code>)</li>
</ul>
</div></blockquote>
</dd>
<dt>output: str</dt>
<dd>Name of the output FITS file.</dd>
<dt>dqicorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Update the dq array from bad pixel table</dd>
<dt>darkcorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Subtract the dark image</dd>
<dt>flatcorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Multiply by the flatfield image</dd>
<dt>shadcorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Correct for shutter shading (CCD)</dd>
<dt>photcorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Update photometry keywords in the header</dd>
<dt>fluxcorr; str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Perform chip photometry normalization</dd>
<dt>verbose: bool, optional</dt>
<dd>Print verbose time stamps?</dd>
<dt>quiet: bool, optional</dt>
<dd>Print messages only to trailer file?</dd>
</dl>
</div></blockquote>
<p><strong>The wf32d function can also be called directly from the OS command line:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">wf32d</span><span class="o">.</span><span class="n">e</span> <span class="nb">input</span> <span class="n">output</span> <span class="p">[</span><span class="o">-</span><span class="n">options</span><span class="p">]</span>
</pre></div>
</div>
<p>Where the OS options include:</p>
<ul class="simple">
<li>-v: verbose</li>
<li>-f: print time stamps</li>
<li>-d: debug</li>
<li>-dark: perform dark subtraction</li>
<li>-dqi: update the DQ array</li>
<li>-flat: perform flat correction</li>
<li>-shad: perform shading correction</li>
<li>-phot: perform phot correction</li>
</ul>
</dd></dl>

</div>
<div class="section" id="module-wfc3tools.wf3ccd">
<span id="wfc3tools-wf3ccd-module"></span><h2>wfc3tools.wf3ccd module<a class="headerlink" href="#module-wfc3tools.wf3ccd" title="Permalink to this headline">¶</a></h2>
<p>wf3ccd  calls the wf3ccd executable and contains the initial processing steps for all the WFC3 UVIS channel data.</p>
<dl class="function">
<dt id="wfc3tools.wf3ccd.getHelpAsString">
<code class="descclassname">wfc3tools.wf3ccd.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3ccd.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Return documentation on the &#8216;wf3ir&#8217; function. Required by TEAL.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3ccd.help">
<code class="descclassname">wfc3tools.wf3ccd.</code><code class="descname">help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3ccd.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3ccd.run">
<code class="descclassname">wfc3tools.wf3ccd.</code><code class="descname">run</code><span class="sig-paren">(</span><em>configobj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3ccd.run" title="Permalink to this definition">¶</a></dt>
<dd><p>TEAL interface for the <code class="docutils literal"><span class="pre">wf3ccd</span></code> function.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3ccd.wf3ccd">
<code class="descclassname">wfc3tools.wf3ccd.</code><code class="descname">wf3ccd</code><span class="sig-paren">(</span><em>input</em>, <em>output=''</em>, <em>dqicorr='PERFORM'</em>, <em>atodcorr='PERFORM'</em>, <em>blevcorr='PERFORM'</em>, <em>biascorr='PERFORM'</em>, <em>flashcorr='PERFORM'</em>, <em>verbose=False</em>, <em>quiet=True</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3ccd.wf3ccd" title="Permalink to this definition">¶</a></dt>
<dd><p>wf3ccd Version 1.3.1  updated on  03-Jan-2013</p>
<p>This routine contains the initial processing steps for all the WFC3 UVIS channel data. These steps are:</p>
<blockquote>
<div><ul class="simple">
<li>DQICORR - initializing the data quality array</li>
<li>ATODCORR - perform the a to d conversion correction</li>
<li>BLEVCORR - subtract the bias level from the overscan region</li>
<li>BIASCORR - subtract the bias image</li>
<li>FLSHCORR - subtract the post-flash image</li>
</ul>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">wf3ccd</span></code> first subtracts the bias and trims the overscan regions from the image. If an associated set of UVIS CR-SPLIT or REPEAT-OBS images is being processed, 
all of the overscan-trimmed images are sent through <code class="docutils literal"><span class="pre">wf3rej</span></code> to be combined and receive cosmic-ray rejection. The resulting combined image then receives final calibration with <code class="docutils literal"><span class="pre">wf32d</span></code>, 
which includes dark subtraction and flat-fielding. If there are multiple sets of CR-SPLIT or REPEAT-OBS images in an association, each set goes through the cycle of <code class="docutils literal"><span class="pre">wf3ccd</span></code>, <code class="docutils literal"><span class="pre">wf3rej</span></code> 
and <code class="docutils literal"><span class="pre">wf32d</span></code> processing.</p>
<p>If BLEVCORR is performed the output contains the overcan-trimmed region.</p>
<p>Only those steps with a switch value of PERFORM in the input files will be executed, after which the switch
will be set to COMPLETE in the corresponding output files.</p>
<blockquote>
<div><p>In Python without TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf3ccd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf3ccd</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>In Python with TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stsci.tools</span> <span class="kn">import</span> <span class="n">teal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf3ccd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teal</span><span class="o">.</span><span class="n">teal</span><span class="p">(</span><span class="s1">&#39;wf3ccd&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In Pyraf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wfc3tools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epar</span> <span class="n">wf3ccd</span>
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><dl class="docutils">
<dt>input <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Name of input files</p>
<blockquote class="last">
<div><ul class="simple">
<li>a single filename (<code class="docutils literal"><span class="pre">iaa012wdq_raw.fits</span></code>)</li>
<li>a Python list of filenames</li>
<li>a partial filename with wildcards (<code class="docutils literal"><span class="pre">\*raw.fits</span></code>)</li>
<li>filename of an ASN table (<code class="docutils literal"><span class="pre">\*asn.fits</span></code>)</li>
<li>an at-file (<code class="docutils literal"><span class="pre">&#64;input</span></code>)</li>
</ul>
</div></blockquote>
</dd>
<dt>output: str</dt>
<dd>Name of the output FITS file.</dd>
<dt>dqicorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Update the dq array from bad pixel table</dd>
<dt>atodcorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Analog to digital correction</dd>
<dt>blevcorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Subtract bias from overscan regions</dd>
<dt>biascorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Subtract bias image</dd>
<dt>flashcorr: str, &#8220;PERFORM/OMIT&#8221;, optional</dt>
<dd>Subtract post-flash image</dd>
<dt>verbose: bool, optional</dt>
<dd>Print verbose time stamps?</dd>
<dt>quiet: bool, optional</dt>
<dd>Print messages only to trailer file?</dd>
</dl>
</div></blockquote>
<p><strong>The wf3ccd function can also be called directly from the OS command line:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">wf32ccd</span><span class="o">.</span><span class="n">e</span> <span class="nb">input</span> <span class="n">output</span> <span class="p">[</span><span class="o">-</span><span class="n">options</span><span class="p">]</span>
</pre></div>
</div>
<p>Where the OS options include:</p>
<ul class="simple">
<li>-v: verbose</li>
<li>-f: print time stamps</li>
<li>-dqi: udpate the DQ array</li>
<li>-atod: perform gain correction</li>
<li>-blev: subtract bias from overscan</li>
<li>-bias: perform bias correction</li>
<li>-flash: remove post-flash image</li>
</ul>
</dd></dl>

</div>
<div class="section" id="module-wfc3tools.wf3cte">
<span id="wfc3tools-wf3cte-module"></span><h2>wfc3tools.wf3cte module<a class="headerlink" href="#module-wfc3tools.wf3cte" title="Permalink to this headline">¶</a></h2>
<p>wf3cte  calls the wf3cte executable and contains the initial processing steps for all the WFC3 UVIS channel data.</p>
<dl class="function">
<dt id="wfc3tools.wf3cte.getHelpAsString">
<code class="descclassname">wfc3tools.wf3cte.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3cte.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Return documentation on the &#8216;wf3cte&#8217; function. Required by TEAL.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3cte.help">
<code class="descclassname">wfc3tools.wf3cte.</code><code class="descname">help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3cte.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3cte.run">
<code class="descclassname">wfc3tools.wf3cte.</code><code class="descname">run</code><span class="sig-paren">(</span><em>configobj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3cte.run" title="Permalink to this definition">¶</a></dt>
<dd><p>TEAL interface for the <code class="docutils literal"><span class="pre">wf3cte</span></code> function.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3cte.wf3cte">
<code class="descclassname">wfc3tools.wf3cte.</code><code class="descname">wf3cte</code><span class="sig-paren">(</span><em>input</em>, <em>parallel=True</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3cte.wf3cte" title="Permalink to this definition">¶</a></dt>
<dd><p>wf3cte Version 1.3.1  updated on  28-Sep-2015</p>
<p>The charge transfer efficiency (CTE) of the UVIS detector has inevitably been declining over time as on-orbit radiation damage creates charge traps in the CCDs. Faint sources in particular can suffer large flux losses or even be lost entirely if observations are not planned and analyzed carefully. The CTE loss will depend on the morphology of the source, the distribution of electrons in the field of view (from sources, background, cosmic rays, and hot pixels) and the population of charge traps in the detector column between the source and the transfer register. And the magnitude of the CTE loss increases continuously with time as new charge traps form.</p>
<p>CTE is typically measured as a pixel-transfer efficiency, and would be unity for a perfect CCD. One indicator of CTE is the Extended Pixel Edge Response (EPER). Inefficient transfer of electrons in a flat-field exposure produces an exponential tail of charge in the overscan region. Analysis of monitoring observations through January 2013 shows that CTE continues to decline linearly over time (<a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/ISRs/WFC3-2013-03.pdf">WFC3 ISR 2013-03</a>).</p>
<p>The CTE correction step uses it&#8217;s own dark reference files which have themselves been corrected for CTE. The specific reference file used for any dataset may be found in the image header keyword DRKCFILE. This step also uses a special bias reference file as part of the CTE correction itself, referred to in the header by the BIACFILE keyword. This BIACFILE is only used to facilitate the CTE correction, the resulting corrected image then uses the normal BIASFILE to correct the science frame after the CTE correction has been performed. After the CTE correction has been performed and the data progresses through the rest of the pipeline, the special CTE corrected dark, DRKCFILE in the header, will be used for the dark current correction instead of the DARKFILE.</p>
<p>There is a PCTETAB refrence file which contains extensions of calibration images and tables of parameters used during the CTE correction stage. The header of this file also contains parameters for the CTE correction algorithm. These parameters, and important scalars which are used to correct the data are stored in the output image headers.
See the UVIS2.0 reference ISR for more information.</p>
<p>This routine performs the CTE correction on raw data files. The calibration step keyword is PCTECORR, if this is set to PERFORM then the CTE correction will be applied to the dataset. Some caveats for its use:</p>
<ul class="simple">
<li>CTE corrections can <em>ONLY</em> be performed on RAW data which has not been calibrated in any way.</li>
<li>Data which have already been through BLEVCORR, BIASCORR or DARKCORR will be rejected.</li>
<li>The CTE correction step in the pipeline is currently only implemented for FULL FRAME images</li>
</ul>
<p>The standalone call will produce a RAC fits file by default. This contains only the CTE corrected data, no other calibrations have been performed.</p>
<p>For more information the the WFC3 CTE please see <a class="reference external" href="http://www.stsci.edu/hst/wfc3/ins_performance/CTE/">the WFC3 CTE webpage</a> .</p>
<blockquote>
<div><p>In Python without TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf3cte</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf3cte</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>In Python with TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stsci.tools</span> <span class="kn">import</span> <span class="n">teal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf3cte</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teal</span><span class="o">.</span><span class="n">teal</span><span class="p">(</span><span class="s1">&#39;wf3cte&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In Pyraf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wfc3tools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epar</span> <span class="n">wf3cte</span>
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><dl class="docutils">
<dt>input <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Name of input files</p>
<blockquote class="last">
<div><ul class="simple">
<li>a single filename (<code class="docutils literal"><span class="pre">iaa012wdq_raw.fits</span></code>)</li>
<li>a Python list of filenames</li>
<li>a partial filename with wildcards (<code class="docutils literal"><span class="pre">\*raw.fits</span></code>)</li>
<li>filename of an ASN table (<code class="docutils literal"><span class="pre">\*asn.fits</span></code>)</li>
<li>an at-file (<code class="docutils literal"><span class="pre">&#64;input</span></code>)</li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>-1 : value, as in minus one, this will make sure only 1 processor/thread is used during processing, otherwise all available are used.</p>
<dl class="docutils">
<dt>verbose: bool, optional</dt>
<dd>Print verbose time stamps?</dd>
</dl>
</div></blockquote>
<p><strong>The wf3cte function can also be called directly from the OS command line:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">wf3cte</span><span class="o">.</span><span class="n">e</span> <span class="nb">input</span>  <span class="p">[</span><span class="o">-</span><span class="n">options</span><span class="p">]</span>
</pre></div>
</div>
<p>Where the OS options include:</p>
<ul class="simple">
<li>-v: verbose</li>
<li>-1: turn off multiprocessing</li>
</ul>
<ul class="simple">
<li>The reference bias image named in the BIACFILE header keyword is subtracted from the data</li>
<li>Parameters from the CTE parameter table, referenced in the PCTETAB header keyword, are read and stored</li>
<li>The date is reformated so that each quadrant has been rotated such that the readout amp is located at the lower left of the array. The reoriented four quadrants are then arranged into a single 8412x2070 image (including the overscan) with amps CDAB in that order. In this format, the pixels are all parallel-shifted down, then serial-shifted to the left</li>
<li>An additional bias correction is performed using the residual bias level measured for each amplifier from the steadiest pixels in the horizontal overscan, this value is then subtracted from all the pixels in each respective amp</li>
<li>The image is corrected for gain</li>
<li>The smoothest  image that is consistent with being the observed image plus readnoise is found and subtracted. This is necessary becasue we want the CTE correction algorithm to produce the smoothest possible reconstruction, consistent with the original image and the known readnoise. The algorithm then constructs a model that is smoother where there pixel-to-pixel variations aren&#8217;t too large, then it respects the pixel values, using a 2sigma threshold to mitigate readnoise amplification, iteration is not done when the deblurring is less than the readnoise.</li>
<li>The CTE correction itself is calculated and then subtracted from the original, raw, uncorrected and uncalibrated image.</li>
<li>The corrected image is now ready to contiue through the rest of the pipeline. When the DARKCORR header keyword is set to perform, the CTE corrected image will use the dark reference file referred to in the DRKCFILE header keyword.</li>
</ul>
<div class="figure align-center" id="id22">
<span id="uvis-raw-data-format"></span><img alt="UVIS data raw full-frame file format" src="_images/raw_uvis_format.png" />
<p class="caption"><span class="caption-text">Figure 8: UVIS data raw full-frame file format</span></p>
</div>
<p>The following are new primary header keyords which will be updated in the data headers during the <cite>wf3cte</cite> step. They are also specified in the PCTETAB reference file.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">KEYWORD</th>
<th class="head">DESCRIPTION</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CTE_NAME</td>
<td>name of cte algorithm [string]</td>
</tr>
<tr class="row-odd"><td>CTE_VER</td>
<td>version number of cte algorithm [string]</td>
</tr>
<tr class="row-even"><td>CTEDATE0</td>
<td>date of wfc3/uvis installation in HST, in modified Julian days (MJD)</td>
</tr>
<tr class="row-odd"><td>CTEDATE1</td>
<td>reference date of CTE model pinning, in modified Julian days (MJD)</td>
</tr>
<tr class="row-even"><td>PCTELEN</td>
<td>max length of CTE trail</td>
</tr>
<tr class="row-odd"><td>PCTERNOI</td>
<td>readnoise amplitude for clipping</td>
</tr>
<tr class="row-even"><td>PCTENFOR</td>
<td>number of iterations used in CTE forward modeling</td>
</tr>
<tr class="row-odd"><td>PCTENPAR</td>
<td>number of iterations used in the parallel transfer</td>
</tr>
<tr class="row-even"><td>PCTENSMD</td>
<td>readnoise mitigation algorithm</td>
</tr>
<tr class="row-odd"><td>PCTETRSH</td>
<td>over-subtraction threshold</td>
</tr>
<tr class="row-even"><td>PCTEFRAC</td>
<td>cte scaling frac calculated from expstart and used in the algorithm</td>
</tr>
<tr class="row-odd"><td>PCTERNOI</td>
<td>the readnoise clipping level to use</td>
</tr>
<tr class="row-even"><td>FIXROCR</td>
<td>make allowance for readout cosmic rays</td>
</tr>
</tbody>
</table>
<p>The PCTETAB reference file has 4 extensions, two tables and two images:</p>
<div class="highlight-python"><div class="highlight"><pre>Filename: wfc3_cte.fits
No.    Name         Type      Cards   Dimensions   Format
0    PRIMARY     PrimaryHDU      21   ()              
1    QPROF       BinTableHDU     16   999R x 3C    [&#39;i&#39;, &#39;i&#39;, &#39;i&#39;]   
2    SCLBYCOL    BinTableHDU     20   8412R x 5C   [&#39;i&#39;, &#39;e&#39;, &#39;e&#39;, &#39;e&#39;, &#39;e&#39;]   
3    RPROF       ImageHDU        12   (999, 100)   float32   
4    CPROF       ImageHDU        12   (999, 100)   float32   
</pre></div>
</div>
<p>The first extension lists the charge-trap levels, the columns are respectively the trap number, the charge-packet size it applies to (in electrons), and the size of the trap (also in electrons).</p>
<p>The second extension contains the CTE scalings as a function of column number. There are 5 columns, each with 8412 elements. The first column contains the integer column number in the amp readout-aligned large array. The other columns contain the CTE scaling appropriate for that column at the 512th, 1024th, 1536th and 2048th rows respectively.</p>
<p>The third extension contains the differential CTE trail profile as a function of charge level in the form of an image</p>
<p>The fourth extension contains the cumulative CTE trail profile as a function of charge level, also in the form of an image.</p>
<p>If you are running the separate <cite>wf3cte.e</cite> step a _rac.fits file will be output. This the same as a _raw.fits file except the CTE correction has been applied to the data.</p>
<p>If the PCTECORR step is set to PEFORM:</p>
<ul class="simple">
<li>when the _raw.fits file enters calwf3, then no intermediate _rac.fits file will be saved, unless you specify the <cite>-s</cite> flag, which instructs <cite>calwf3.e</cite> to save all intermediate files.</li>
<li>the <cite>calwf3</cite> pipeline will produce both CTE calibrated product and non-CTE calibrated products. The CTE products have a &#8216;c&#8217; at the end of their extension name, such as _blc, _rac, _crc, _flc, and the non-CTE calibrated products contain the familiar : _blv, _crj, _flt.</li>
</ul>
</dd></dl>

</div>
<div class="section" id="module-wfc3tools.wf3ir">
<span id="wfc3tools-wf3ir-module"></span><h2>wfc3tools.wf3ir module<a class="headerlink" href="#module-wfc3tools.wf3ir" title="Permalink to this headline">¶</a></h2>
<p>The wf3ir  processes IR images</p>
<dl class="function">
<dt id="wfc3tools.wf3ir.getHelpAsString">
<code class="descclassname">wfc3tools.wf3ir.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3ir.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Return documentation on the &#8216;wf3ir&#8217; function. Required by TEAL.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3ir.help">
<code class="descclassname">wfc3tools.wf3ir.</code><code class="descname">help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3ir.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Print out syntax help for running wf3ir</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3ir.run">
<code class="descclassname">wfc3tools.wf3ir.</code><code class="descname">run</code><span class="sig-paren">(</span><em>configobj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3ir.run" title="Permalink to this definition">¶</a></dt>
<dd><p>TEAL interface for the <code class="docutils literal"><span class="pre">wf3ir</span></code> function.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3ir.wf3ir">
<code class="descclassname">wfc3tools.wf3ir.</code><code class="descname">wf3ir</code><span class="sig-paren">(</span><em>input</em>, <em>output=''</em>, <em>verbose=False</em>, <em>quiet=True</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3ir.wf3ir" title="Permalink to this definition">¶</a></dt>
<dd><p>wf3ir Version 1.3.1  updated on  03-Jan-2013</p>
<p>Use this function to facilitate batch runs or for the TEAL interface.</p>
<p>This routine contains all the instrumental calibration steps for WFC3 IR channel images. The steps are:</p>
<blockquote>
<div><ul class="simple">
<li>DQICORR - initialize the data quality array</li>
<li>ZSIGCORR - estimate the amount of signal in the zeroth-read</li>
<li>BLEVCORR - subtact the bias level from the reference pixels</li>
<li>ZOFFCORR - subtract the zeroth read image</li>
<li>NLINCORR - correct for detector non-linear response</li>
<li>DARKCORR - subtract the dark current image</li>
<li>PHOTCORR - compute the photometric keyword values</li>
<li>UNITCORR - convert to units of count rate</li>
<li>CRCORR - fit accumulating signal and identify the cr hits</li>
<li>FLATCORR - divide by the flatfield images and apply gain coversion</li>
</ul>
</div></blockquote>
<p>The output images include the calibrated image ramp (ima file) and the accumulated ramp image (flt file)</p>
<p>Only those steps with a switch value of PERFORM in the input files will be executed, after which the switch
will be set to COMPLETE in the corresponding output files.</p>
<blockquote>
<div><p>In Python without TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf3ir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf3ir</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>In Python with TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stsci.tools</span> <span class="kn">import</span> <span class="n">teal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf3ir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teal</span><span class="o">.</span><span class="n">teal</span><span class="p">(</span><span class="s1">&#39;wf3ir&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In Pyraf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wfc3tools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epar</span> <span class="n">wf3ir</span>
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><dl class="docutils">
<dt>input <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Name of input files</p>
<blockquote class="last">
<div><ul class="simple">
<li>a single filename (<code class="docutils literal"><span class="pre">iaa012wdq_raw.fits</span></code>)</li>
<li>a Python list of filenames</li>
<li>a partial filename with wildcards (<code class="docutils literal"><span class="pre">\*raw.fits</span></code>)</li>
<li>filename of an ASN table (<code class="docutils literal"><span class="pre">\*asn.fits</span></code>)</li>
<li>an at-file (<code class="docutils literal"><span class="pre">&#64;input</span></code>)</li>
</ul>
</div></blockquote>
</dd>
<dt>output: str</dt>
<dd>Name of the output FITS file.</dd>
<dt>verbose: bool, optional</dt>
<dd>Print verbose time stamps?</dd>
<dt>quiet: bool, optional</dt>
<dd>Print messages only to trailer file?</dd>
</dl>
</div></blockquote>
<p><strong>The wf3ir function can also be called directly from the OS command line:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">wf32ir</span><span class="o">.</span><span class="n">e</span> <span class="nb">input</span> <span class="n">output</span> <span class="p">[</span><span class="o">-</span><span class="n">options</span><span class="p">]</span>
</pre></div>
</div>
<p>Where the OS options include:</p>
<ul class="simple">
<li>-v: verbose</li>
<li>-f: print time stamps</li>
</ul>
</dd></dl>

</div>
<div class="section" id="module-wfc3tools.wf3rej">
<span id="wfc3tools-wf3rej-module"></span><h2>wfc3tools.wf3rej module<a class="headerlink" href="#module-wfc3tools.wf3rej" title="Permalink to this headline">¶</a></h2>
<p>wf3rej contains the Cosmic Ray rejection and shading correction processing steps for  the WFC3 UVIS and IR data. These steps are:</p>
<dl class="function">
<dt id="wfc3tools.wf3rej.getHelpAsString">
<code class="descclassname">wfc3tools.wf3rej.</code><code class="descname">getHelpAsString</code><span class="sig-paren">(</span><em>docstring=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3rej.getHelpAsString" title="Permalink to this definition">¶</a></dt>
<dd><p>Return documentation on the &#8216;wf3ir&#8217; function. Required by TEAL.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3rej.help">
<code class="descclassname">wfc3tools.wf3rej.</code><code class="descname">help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3rej.help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3rej.run">
<code class="descclassname">wfc3tools.wf3rej.</code><code class="descname">run</code><span class="sig-paren">(</span><em>configobj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3rej.run" title="Permalink to this definition">¶</a></dt>
<dd><p>TEAL interface for the <code class="docutils literal"><span class="pre">wf3rej</span></code> function.</p>
</dd></dl>

<dl class="function">
<dt id="wfc3tools.wf3rej.wf3rej">
<code class="descclassname">wfc3tools.wf3rej.</code><code class="descname">wf3rej</code><span class="sig-paren">(</span><em>input</em>, <em>output=''</em>, <em>crrejtab=''</em>, <em>scalense=''</em>, <em>initgues=''</em>, <em>skysub=''</em>, <em>crsigmas=''</em>, <em>crradius=0</em>, <em>crthresh=0</em>, <em>badinpdq=0</em>, <em>crmask=False</em>, <em>shadcorr=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wfc3tools.wf3rej.wf3rej" title="Permalink to this definition">¶</a></dt>
<dd><p>wf3rej Version 1.3.1  updated on  12-Jul-2013</p>
<p>This calls the wf3rej executable. Use this function to facilitate batch runs or for the TEAL interface.</p>
<p>In Python without TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf3rej</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf3rej</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>In Python with TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stsci.tools</span> <span class="kn">import</span> <span class="n">teal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">wf3rej</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teal</span><span class="o">.</span><span class="n">teal</span><span class="p">(</span><span class="s1">&#39;wf3rej&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In Pyraf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wfc3tools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epar</span> <span class="n">wf3rej</span>
</pre></div>
</div>
<p>input : str, Name of input files</p>
<blockquote>
<div><ul class="simple">
<li>a single filename (<code class="docutils literal"><span class="pre">iaa012wdq_raw.fits</span></code>)</li>
<li>a Python list of filenames</li>
<li>a partial filename with wildcards (<code class="docutils literal"><span class="pre">\*raw.fits</span></code>)</li>
<li>filename of an ASN table (<code class="docutils literal"><span class="pre">\*asn.fits</span></code>)</li>
<li>an at-file (<code class="docutils literal"><span class="pre">&#64;input</span></code>)</li>
</ul>
</div></blockquote>
<p>output : str, Name of the output FITS file.</p>
<p>crrejtab : string, reference file name</p>
<p>scalense :   string, scale factor applied to noise</p>
<p>initgues :   string, intial value estimate scheme (min|med)</p>
<p>skysub :     string, how to compute the sky (none|mode|mean)</p>
<p>crsigmas :   string, rejection levels in each iteration</p>
<p>crradius :   float, cosmic ray expansion radius in pixels</p>
<p>crthresh :   float, rejection propagation threshold</p>
<p>badinpdq :   int, data quality flag bits to reject</p>
<p>crmask :     bool, flag CR in input DQ imageS?</p>
<p>shadcorr :   bool, perform shading shutter correction?</p>
<p>verbose : bool, optional,  Print verbose time stamps?</p>
<p><strong>The wf3rej executable can also be called directly from the OS command line prompt:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">wf3rej</span><span class="o">.</span><span class="n">e</span> <span class="nb">input</span> <span class="n">output</span> <span class="p">[</span><span class="o">-</span><span class="n">options</span><span class="p">]</span>
</pre></div>
</div>
<p>Input can be a single file, or a comma-delimited list of files.</p>
<p>Where the OS options include:</p>
<ul class="simple">
<li>t: print the timestamps</li>
<li>v: verbose</li>
<li>shadcorr: perform shading shutter correction?</li>
<li>crmask: flag CR in input DQ images?</li>
<li>table &lt;filename&gt;: the crrejtab filename</li>
<li>scale &lt;number&gt;: scale factor for noise</li>
<li>init &lt;med|min&gt;: initial value estimate scheme</li>
<li>sky &lt;none|median|mode&gt;: how to compute sky</li>
<li>sigmas: rejection leves for each iteration</li>
<li>radius &lt;number&gt;: CR expansion radius</li>
<li>thresh &lt;number&gt; : rejection propagation threshold</li>
<li>pdq &lt;number&gt;: data quality flag bits to reject</li>
</ul>
</dd></dl>

</div>
<div class="section" id="module-wfc3tools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-wfc3tools" title="Permalink to this headline">¶</a></h2>
<p>The wfc3tools package holds Python tasks useful for analyzing WFC3 data.</p>
<p>These tasks include:</p>
<p>Utility and library functions used by these tasks are also included in this
module.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012, STScI.
      Last updated on Feb 23, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.3.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>